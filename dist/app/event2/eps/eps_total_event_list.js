"use strict";_SL.nmspc("epsTotalEvent").list=function(){var a={urlList:gCONTEXT_PATH+"event2/eps_total_event_list.json",urlLink:gCONTEXT_PATH+"event2/eps_ip_event_list.html",formId:"#searchEpsTotalEventList",gridId:"#gridEpsTotalEventList"},b={form:$(a.formId),grid:$(a.gridId),sDay:$(a.formId+" [name=startDay]"),sHour:$(a.formId+" [name=startHour]"),sMin:$(a.formId+" [name=startMin]"),eDay:$(a.formId+" [name=endDay]"),eHour:$(a.formId+" [name=endHour]"),eMin:$(a.formId+" [name=endMin]")},c=function(){d(),e()},d=function(){var c=$.extend({},_SL.serializeMap(b.form)),d=function(a){var c=a.list,d=a.eventCates,e=b.grid.find("tbody").empty();for(var g in c){var h=c[g],i=$("<tr>");i.append($("<td>"+h.tc_type_nm+"</td>"));for(var j in d){var k=h["cate"+j+"_cnt"],l=$("<td>").append(k);0!=k&&l.attr("tabindex","1").addClass("color_ec"+j).data({tc_type:h.tc_type,event_cate_cd:j,count:k}),l.appendTo(i)}0==g&&i.append($("<td rowspan='"+c.length+"'>"+h.risk_score+"%</td>")),i.appendTo(e)}f()};$("body").requestData(a.urlList,c,{callback:d})},e=function(){b.form.find(".form-submit").off().on("click",function(){if(_SL.validate(b.form)){var a=b.sDay.val()+b.sHour.val()+b.sMin.val(),c=b.eDay.val()+b.eHour.val()+b.eMin.val(),d=_SL.formatDate.diff(a,c);$("#s_eqp_ip").val();if(d<=0)return void _alert("시작일이 종료일보다 큽니다.");if(d/6e4>b.form.find("[name=timeSet] option:last-child").val())return void _alert("검색 기간 초과입니다.");b.form.find("[name=currPage]").val(1),g()}}),b.form.find("[name=timeSet]").change(function(){var a=this.value;if(0!=a){var c=function(a,b){var c=a.siblings(".tform-select");c.find(".tform-select-t").text(b).end().find(".tform-select-option[data-value="+b+"]").addClass("selected").end(),a.val(b)},d=_SL.formatDate.addMin(b.form.find("[name=endDay]").val()+b.form.find("[name=endHour]").val()+b.form.find("[name=endMin]").val(),-a);c(b.form.find("[name=startDay]"),d.substring(0,8)),c(b.form.find("[name=startHour]"),d.substring(8,10)),c(b.form.find("[name=startMin]"),d.substring(10,12))}}),b.form.find("[name=startDay],[name=startHour],[name=startMin],[name=endDay],[name=endHour],[name=endMin]").change(function(){var a=b.form.find("[name=timeSet]"),c=a.siblings(".tform-select").find("[data-value=0]").text();a.val(0).siblings(".tform-select").find(".tform-select-t").text(c)})},f=function(){b.grid.find("[class*=color_ec]").off().on("click",function(){var b=$(this);$("#tc_type").val(b.data("tc_type")),$("#event_cate_cd").val(b.data("event_cate_cd")),$("#count").val(b.data("count")),$(a.formId)[0].action=a.urlLink,$(a.formId)[0].submit()})},g=function(){d()};return{init:c}}(),$(function(){slapp.epsTotalEvent.list.init(),$("#btnSettingEpsRulesetList").togglePage(gCONTEXT_PATH+"event2/eps_ruleset_list.html"),$("#btnSettingRiskRuleView").off().on("click",function(){new ModalPopup(gCONTEXT_PATH+"event2/eps_event_risk_rule_view.html",{width:820,height:250})})});