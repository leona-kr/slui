"use strict";_SL.nmspc("alarm").riskForm=function(){var a={formId:"#formRiskRuleset",urlSelect:gCONTEXT_PATH+"system/comcode_type_form.json",urlSave:gCONTEXT_PATH+"system/risk_ruleset_update.do"},b={form:$(a.formId)},c=function(){d()},d=function(){b.form.find(".btn-save").on("click",f),b.form.find("[name=ratio]").change(e)},e=function(){var a,c=b.form.find("[name=ratio]"),d=c.length-1,e=parseInt(this.value,10),f=c.eq(d)[0]==this,g=0;if(isNaN(e)||e<0||e>100){_alert("잘못된 입력 값입니다.");for(var h=0;h<=d;h++)a=c.eq(h)[0],this!=a&&(g+=parseInt(a.value,10));return this.value=100-g,this.focus(),!1}c.css("background-color",""),$(this).css("background-color","#ffff44"),g=e;for(var h=0;h<=d;h++)a=c.eq(h)[0],this!=a&&(g+=parseInt(a.value,10),(g>100||h==d+(f?-1:0))&&(a.value=parseInt(a.value,10)+100-g,$(a).css("background-color","#ffff44"),g=100))},f=function(){var c=b.form.find("[name=risk_range_from]"),d=-1;if(_SL.validate(b.form)){for(var e=0;e<c.size();e++){if(parseInt(c.eq(e).val())<=d)return _alert("이전 단계보다 위험율이 커야 합니다."),void c.eq(e).focus();d=parseInt(c.eq(e).val())}var f=1==$(this).data("after-close");$.ajax({url:a.urlSave,type:"POST",dataType:"json",data:b.form.serialize(),success:function(a,b,c){"SUC_COM_0004"==a.result_cd?_alert(a.result_msg,{onAgree:function(){g(f)}}):_alert("저장 처리중 에러가 발생했습니다.<br/> 다시 실행하세요.")}})}},g=function(a){a&&b.form.find("[data-layer-close=true]").click()};return{init:c}}(),$(function(){slapp.alarm.riskForm.init()});