"use strict";_SL.nmspc("logsearch").mainTimelineChart=function(){var a,b,c=gCONTEXT_PATH+"monitoring/",d={DOM:{chart:"#chartWrapper"},URL:{list:c+"log_search_list.json"},cookie:{isShowChartYN:"isShowChartYN"},chartStyle:{caption:"Timeline of Rows",captionFontSize:"11",chartTopMargin:"5",chartBottomMargin:"10",yAxisName:"Count",yAxisMaxValue:5,paletteColors:"#468cdb",bgColor:"#f0f2f0",plotBorderAlpha:"10",placevaluesInside:0,valueFontColor:"#666666",showXAxisLine:"1",showAlternateHGridColor:"0"},chartHeight:130},e={chart:null,charOnoffBtn:null},f={oChart:null,isShowChart:!0,maxValue:0,avgValue:0},g=function(){a=slapp.logsearch.manager,b=slapp.logsearch.dynPaging,f.isShowChart="N"!=$.cookie(d.cookie.isShowChartYN),e.chart=$(d.DOM.chart)},h=function(a){var b=e.chart.is(":visible");a!=b&&(a?e.chart.show():e.chart.hide())},i=function(){var a=j();d.chartStyle=$.extend({},slui.chart.chartConfig,d.chartStyle),f.isShowChart&&h(f.isShowChart),f.maxValue&&(d.chartStyle.yAxisMaxValue=f.maxValue?_SL.getChartMaxValue(f.maxValue):5),d.chartStyle.plotSpacePercent=a.length>=20?a.length>=60?20:45:80,FusionCharts.items.mainTimelineChart?e.chart.updateFusionCharts({dataSource:{chart:d.chartStyle,data:a,styles:d._styles,trendlines:0==f.avgValue?[]:[{line:[{startvalue:f.avgValue,endvalue:"",color:"fda813",displayvalue:" ",tooltext:"Average : "+_SL.formatNumber(f.avgValue),showontop:"1",thickness:"1"}]}]}}):e.chart.insertFusionCharts({id:"mainTimelineChart",type:"column2d",width:"100%",height:d.chartHeight,dataFormat:"json",dataSource:{chart:d.chartStyle,data:a,styles:d._styles,trendlines:0==f.avgValue?[]:[{line:[{startvalue:f.avgValue,endvalue:"",color:"fda813",displayvalue:" ",tooltext:"Average : "+_SL.formatNumber(f.avgValue),showontop:"1",thickness:"1"}]}]}})},j=function(){var a=[],c=0,d=b.getRowsPerTime(),e=d.length,g=e>=60,h=b.isAsc()?"push":"unshift";return f.maxValue=0,f.avgValue=0,$.each(d,function(b,d){var e,i=d.sch_start_time.substring(0,8),j=d.sch_start_time.substring(8,12),k=d.sch_end_time.substring(0,8),l=d.sch_end_time.substring(8,12);e=_SL.formatDate(d.sch_start_time,"HH:mm"),a[h]({label:_SL.formatDate("0000"==l?i:k,"yyyyMMdd","MM/dd"),showLabel:"0000"==j||i!=k&&"0000"!=l?"1":"0",value:d.rows,showValue:g&&b%2?"0":"1",link:"javascript:slapp.logsearch.mainTimelineChart.openSearch('"+d.sch_start_time+"','"+d.sch_end_time+"');",toolText:e+"~"+_SL.formatDate(d.sch_end_time,"HH:mm")+", "+_SL.formatNumber(d.rows)}),f.maxValue=Math.max(f.maxValue,d.rows),c+=d.rows}),e>0&&(f.avgValue=c/e),a},k=function(b,c){a.openSearch({start_time:b,end_time:c})};return{init:g,show:h,update:i,openSearch:k}}();