"use strict";_SL.nmspc("performance").list=function(){var a={urlList:gCONTEXT_PATH+"monitoring/performance_list.json",urlLoadEqp:gCONTEXT_PATH+"common/equipment_list.json",urlView:gCONTEXT_PATH+"monitoring/performance_view.html",gridId:"#gridPerformInfoList",formId:"#searchPerformList"},b={form:$(a.formId),grid:$(a.gridId),eqpIp:$(a.formId+" [name=s_eqp_ip]"),eqpIp2:$(a.formId+" [name=s_eqp_ip2]"),eqpNm:$(a.formId+" [name=s_eqp_nm]"),eqpTyp:$(a.formId+" [name=s_eqp_type_cd]")},c=function(){d(b.grid),f()},d=function(b){var c={datatype:"json",datafields:[{name:"eqp_ip",type:"string"},{name:"eqp_type_cd",type:"string"},{name:"eqp_nm",type:"string"},{name:"eqp_time",type:"string"},{name:"cpu_low",type:"string"},{name:"mem_low",type:"string"},{name:"trs_io_read",type:"string"},{name:"trs_io_write",type:"string"},{name:"trs_net_tx",type:"string"},{name:"trs_net_rx",type:"string"},{name:"cpu_status",type:"string"},{name:"mem_status",type:"string"},{name:"io_read_status",type:"string"},{name:"io_write_status",type:"string"},{name:"net_rx_status",type:"string"},{name:"net_tx_status",type:"string"},{name:"cpu_used",type:"string"},{name:"mem_used",type:"string"},{name:"read_bytes",type:"string"},{name:"write_bytes",type:"string"},{name:"rx_bytes",type:"string"},{name:"tx_bytes",type:"string"}],root:"rows",beforeprocessing:function(a){null!=a&&(c.totalrecords=a.totalRows)},cache:!1,url:a.urlList},d=new $.jqx.dataAdapter(c,{beforeLoadComplete:function(a){for(var b in a)a[b].cpu_low=null==a[b].cpu_low?"-":a[b].cpu_low,a[b].cpu_used=null==a[b].cpu_used?"-":a[b].cpu_used,a[b].mem_low=null==a[b].mem_low?"-":a[b].mem_low,a[b].mem_used=null==a[b].mem_used?"-":a[b].mem_used,a[b].read_bytes=null==a[b].read_bytes?"-":_SL.formatNumber(a[b].read_bytes/1048576),a[b].write_bytes=null==a[b].write_bytes?"-":_SL.formatNumber(a[b].write_bytes/1048576),a[b].rx_bytes=null==a[b].rx_bytes?"-":_SL.formatNumber(a[b].rx_bytes/1048576),a[b].tx_bytes=null==a[b].tx_bytes?"-":_SL.formatNumber(a[b].tx_bytes/1048576),a[b].trs_io_read=null==a[b].trs_io_read?"-":_SL.formatNumber(a[b].trs_io_read/1048576),a[b].trs_io_write=null==a[b].trs_io_write?"-":_SL.formatNumber(a[b].trs_io_write/1048576),a[b].trs_net_rx=null==a[b].trs_net_rx?"-":_SL.formatNumber(a[b].trs_net_rx/1048576),a[b].trs_net_tx=null==a[b].trs_net_tx?"-":_SL.formatNumber(a[b].trs_net_tx/1048576);return a},formatData:function(b){var c,d={},e=$(a.formId).serializeArray();for(c in e)d[e[c].name]=e[c].value;return $.extend(b,d),b},loadError:function(a,b,c){_alert(c)}}),f='<span class="label-info">정상</span>',g='<span class="label-attention">비정상 Low</span>',h='<span class="label-warning">비정상 Middle</span>',i='<span class="label-danger">비정상 High</span>';b.jqxGrid({source:d,width:"100%",virtualmode:!0,enablehover:!1,rendergridrows:function(a){return a.data},columns:[{text:"No",columntype:"number",width:40,cellsalign:"center",cellsrenderer:function(a,b,c,d){return $(d).text(c+1)[0].outerHTML}},{text:"장비명[IP]",datafield:"eqp_nm",width:"25%",cellsalign:"center",cellsrenderer:function(a,b,c,d,e,f){return'<div class="jqx-grid-cell-middle-align" style="margin-top: 4px;"><button type="button" class="btn-link" data-type-cd="'+f.s_eqp_type_cd+'">'+c+"["+f.eqp_ip+"]</button></div>"}},{text:"CPU(%)<br>측정값/임계치",datafield:"cpu_status",width:"12%",cellsalign:"center",rendered:function(a){a.css("margin-top","16px")},cellsrenderer:function(a,b,c,d,e,j){if("0"===c)var k=f;else if("1"===c)var k=g;else if("2"===c)var k=h;else if("3"===c)var k=i;return $(d).html(k+" ["+j.cpu_used+" / "+j.cpu_low+"]")[0].outerHTML}},{text:"Memory(%)<br>측정값/임계치",datafield:"mem_status",width:"12%",cellsalign:"center",rendered:function(a){a.css("margin-top","16px")},cellsrenderer:function(a,b,c,d,e,j){if("0"===c)var k=f;else if("1"===c)var k=g;else if("2"===c)var k=h;else if("3"===c)var k=i;return $(d).html(k+" ["+j.mem_used+" / "+j.mem_low+"]")[0].outerHTML}},{text:"Read",datafield:"io_read_status",columngroup:"disk_mbps",width:"12%",cellsalign:"center",cellsrenderer:function(a,b,c,d,e,j){if("0"===c)var k=f;else if("1"===c)var k=g;else if("2"===c)var k=h;else if("3"===c)var k=i;return $(d).html(k+" ["+j.read_bytes+" / "+j.trs_io_read+"]")[0].outerHTML}},{text:"Write",datafield:"io_write_status",columngroup:"disk_mbps",width:"12%",cellsalign:"center",cellsrenderer:function(a,b,c,d,e,j){if("0"===c)var k=f;else if("1"===c)var k=g;else if("2"===c)var k=h;else if("3"===c)var k=i;return $(d).html(k+" ["+j.write_bytes+" / "+j.trs_io_write+"]")[0].outerHTML}},{text:"Inbound",datafield:"net_rx_status",columngroup:"netw_mbps",width:"12%",cellsalign:"center",cellsrenderer:function(a,b,c,d,e,j){if("0"===c)var k=f;else if("1"===c)var k=g;else if("2"===c)var k=h;else if("3"===c)var k=i;return $(d).html(k+" ["+j.rx_bytes+" / "+j.trs_net_rx+"]")[0].outerHTML}},{text:"Outbound",datafield:"net_tx_status",columngroup:"netw_mbps",cellsalign:"center",cellsrenderer:function(a,b,c,d,e,j){if("0"===c)var k=f;else if("1"===c)var k=g;else if("2"===c)var k=h;else if("3"===c)var k=i;return $(d).html(k+" ["+j.tx_bytes+" / "+j.trs_net_tx+"]")[0].outerHTML}}],columngroups:[{text:"Disk(MBps)",align:"center",name:"disk_mbps"},{text:"Network(MBps)",align:"center",name:"netw_mbps"}]}),b.on("cellclick",function(b){if("eqp_nm"===b.args.datafield){var c=b.args.row.bounddata,d=c.eqp_ip,f=c.eqp_type_cd,g=(c.eqp_time,_SL.formatDate.addMin(c.eqp_time,1)),h=_SL.formatDate.addMin(g,-30);e(a.urlView+"?s_eqp_type_cd="+f+"&s_eqp_ip="+d+"&start_time="+h+"&end_time="+g)}})},e=function(a){new ModalPopup(a,{width:1e3,height:820,setScroll:!0,onClose:function(){h()}})},f=function(){b.form.find(".form-submit").off().on("click",function(){_SL.validate(b.form)&&h()}),g(),$("[name=s_eqp_type_cd]").change(function(){g()})},g=function(){var c=b.eqpTyp.val();b.form.find("[name=s_eqp_ip]").html('<option value="">[선택하세요]</option>');if(""!=c){var d={s_eqp_type_cd:c},e=function(c){var d=c.eqp_list;for(var e in d){var f=d[e].eqp_ip,g=d[e].eqp_nm;b.eqpIp.append('<option value="'+f+'">'+g+"("+f+")</option>")}slui.attach.setTransformSelect(a.formId)};$("body").requestData(a.urlLoadEqp,d,{callback:e})}},h=function(){b.grid.jqxGrid("updatebounddata")};return{init:c}}(),$(function(){slapp.performance.list.init()});