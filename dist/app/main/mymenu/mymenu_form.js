"use strict";_SL.nmspc("main").mymenuForm=function(){var a={urlSave:gCONTEXT_PATH+"main/mymenu_insert.do",formId:"#setMymenu",mymenu:" .setmenus-group .area-my .inner-wrap",allmenu:".setmenus-group .area-menus ul"},b=function(b){var e=[],f=$("header .group-mymenu .item-menu");f.each(function(){var a=$(this).find("a");e.push({menu_id:Number(a.attr("data-id")),menu_nm:a.text()})}),c(b,e),d(e),$(a.formId+" .btn-save").on("click",h)},c=function(b,c){var d=$(a.allmenu),e=function(a,b,c){var d=$("<li />").appendTo(b);if(a.child.length>0){d.append('<span class="sp-d'+c+'">'+a.menu_nm+"</span>");var f=$("<ul />").appendTo(d);c++;for(var g=0,h=a.child.length;g<h;g++)e(a.child[g],f,c)}else d.append('<label class="sp-d'+c+'"><input type="checkbox" value="'+a.menu_id+'" data-id="'+a.menu_id+'">'+a.menu_nm+"</label>")};d.empty();for(var g=0,h=b.length;g<h;g++)e(b[g],d,1);for(var g=0,h=c.length;g<h;g++)$(a.allmenu+" [data-id="+c[g].menu_id+"]").prop("checked",!0);f()},d=function(b){var c=b;$(a.mymenu).empty();for(var d=0,f=c.length;d<f;d++)e(c[d].menu_id,c[d].menu_nm);g()},e=function(b,c){var d=$("<span />").attr("data-id",b).addClass("item-menu").appendTo($(a.mymenu));$("<span />").text(c).appendTo(d),$("<button />").attr("type","button").addClass("icon-times").appendTo(d).on("click",function(){$(this).parent().remove(),$(a.allmenu+" [data-id="+b+"]").prop("checked",!1)})},f=function(){var b=$(a.allmenu+" [type=checkbox]");b.each(function(){$(this).on("click",function(){$(this).prop("checked")?0==$(a.mymenu).find("[data-id="+$(this).val()+"]").size()&&(e($(this).val(),$(this).parent().text()),g()):$(a.mymenu).find("[data-id="+$(this).val()+"]").remove()})})},g=function(){$(a.mymenu).sortable({items:".item-menu"})},h=function(){var b=[],c=1==$(this).data("after-close");$(a.mymenu+" .item-menu").each(function(){b.push(Number($(this).attr("data-id")))}),$("body").requestData(a.urlSave,b,{displayLoader:!0,callback:function(b,d,e){d.indexOf("SUC")!=-1?c&&$(a.formId+" [data-layer-close=true]").click():_alert(e)}})};return{init:b}}(),$(function(){"undefined"!=typeof gMenuTree.child&&gMenuTree.child.length>0?slapp.main.mymenuForm.init(gMenuTree.child):$("header .btn-setting").hide()});