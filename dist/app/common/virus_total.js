"use strict";_SL.nmspc("virus").total=function(){var a={DOM:{form:"#virusTotalInfo"},URL:{urlVirusTotal:gCONTEXT_PATH+"common/virusTotal.json"}},b={form:$(a.DOM.form),searchTxt:$(a.DOM.form+" [name=search_txt]"),urlTab:$(a.DOM.form+" .urlTab"),fileTab:$(a.DOM.form+" .fileTab"),fTab:$(a.DOM.form+" .tab-file"),btnGoSearch:$(a.DOM.form+" .form-button")},c={},d=function(a){$.extend(c,a),e(),f()},e=function(){b.btnGoSearch.off().on("click",function(){_SL.validate(b.form)&&f()}),b.form.find(".config_tab li").click(function(){g($(this).index())})},f=function(){loading.show();var c={search_txt:b.searchTxt.val()};$("body").requestData(a.URL.urlVirusTotal,c,{callback:function(a){loading.hide();var c=a.fileScanReport,d=a.fileScanInfoArr,e=a.resultStr,f=a.urlScanInfoArr,g=a.urlScanReport,h=a.urlScans,i=b.urlTab,j=b.fileTab,k="<br>";if(i.empty(),""==e||null==e){var l=$("<table>"),m=$("<table>"),n="";n=g.positives>0?"red":"green";var o=$("<tr>");o.append('<td style="padding-right: 10px;font-weight: bold;">탐지 비율 :</td>'),o.append('<td style="color:'+n+';">'+g.positives+" / "+g.total+"</td>");var p=$("<tr>");p.append('<td style="padding-right: 10px;font-weight: bold;">분석 날짜 :</td>'),p.append("<td>"+g.scanDate+" UTC</td>"),l.append(o,p);var q=$("<span>"+g.verboseMessage+"</span>"),r=$('<span><a href="'+g.permalink+'" />" target="_blank">'+g.permalink+"</a></span>"),s=$("<tr>");s.append('<td style="padding-right: 20px;font-weight: bold;">URL 검사기</td>'),s.append('<td style="font-weight: bold;">결과</td>'),m.append(s);for(var t in f){var u=$("<tr>"),v=f[t];h[v].detected?(u.append('<td style="padding-right:20px;">'+v+"</td>"),u.append('<td style="padding-right:20px; color:red;">'+h[v].result+"</td>")):(u.append('<td style="padding-right: 20px;">'+v+"</td>"),u.append('<td style="color:green;">'+h[v].result+"</td>")),m.append(u)}i.append(l,k,m,k,q,k,r)}else i.append("There is no Search Result.<br>"+e);if(j.empty(),""==e||null==e){if(null!=c){b.fTab.css("display","block"),$fTbl1=$("<table>"),$fTbl2=$("<table>");var n="";n=c.positives>0?"red":"green";var o=$("<tr>");o.append('<td style="padding-right: 10px;font-weight: bold;">MD5 :</td>'),o.append("<td>"+c.md5+"</td>");var p=$("<tr>");p.append('<td style="padding-right: 10px;font-weight: bold;">SHA1 :</td>'),p.append("<td>"+c.sha1+"</td>");var s=$("<tr>");s.append('<td style="padding-right: 10px;font-weight: bold;">SHA256 :</td>'),s.append("<td>"+c.sha256+"</td>");var w=$("<tr>");w.append('<td style="padding-right: 10px;font-weight: bold;">탐지 비율 :</td>'),w.append('<td style="color:'+n+';">'+c.positives+" / "+c.total+"</td>");var x=$("<tr>");x.append('<td style="padding-right: 10px;font-weight: bold;">분석 날짜 :</td>'),x.append("<td>"+c.scanDate+"UTC</td>"),$fTbl1.append(o,p,s,w,x),j.append($fTbl1,$br)}if(null!=a.fileScans){var q=$("<span>"+c.verboseMessage+"</span>"),r=$('<span><a href="'+c.permalink+'" />" target="_blank">'+c.permalink+"</a></span>"),o=$("<tr>");o.append('<td style="padding-right: 20px;font-weight: bold;">안티바이러스</td>'),o.append('<td style="padding-right: 20px;font-weight: bold;">결과</td>'),o.append('<td style="font-weight: bold;">업데이트</td>'),$fTbl2.append(o);for(var t in d){var u=$("<tr>"),v=d[t];fileScans[v].detected?(u.append('<td style="padding-right: 20px;">'+v+"</td>"),u.append('<td style="padding-right: 20px;color: red;">'+fileScans[v].result+"</td>"),u.append("<td>"+fileScans[v].update+"</td>")):(u.append('<td style="padding-right: 20px;">'+v+"</td>"),u.append('<td style="padding-right: 20px;color: green;">File not detected. (v'+fileScans[v].version+")</td>"),u.append("<td>"+fileScans[v].update+"</td>")),$fTbl2.append(u)}j.append($fTbl2,$br,q,$br,r)}}else b.fTab.css("display","none");b.form.parents(".nano").nanoScroller()}})},g=function(a){switch(b.form.find(".config_tab li").removeClass("tab-item-active"),b.form.find(".config_tab li").eq(a).addClass("tab-item-active"),a){case 0:b.urlTab.css("display","block"),b.fileTab.css("display","none");break;case 1:b.urlTab.css("display","none"),b.fileTab.css("display","block")}};return{init:d}}(),$(function(){slapp.virus.total.init()});