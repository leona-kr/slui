"use strict";_SL.nmspc("ip").check=function(){var a={DOM:{form:"#searchIpCheckInfo",ipChkInfo:"#IpCheckInfo"},URL:{urlIpcheck:gCONTEXT_PATH+"common/ipcheck.json"}},b={form:$(a.DOM.form),info:$(a.DOM.ipChkInfo),searchIp:$(a.DOM.form+" [name=search_ip]"),asset:$(a.DOM.form+" [name=asset]"),whois:$(a.DOM.form+" [name=whois]"),whoisServer:$(a.DOM.form+" [name=whois_server]"),ping:$(a.DOM.form+" [name=ping]"),nmap:$(a.DOM.form+" [name=nmap]"),btnGoSearch:$(a.DOM.form+" .btn-submit")},c={},d=function(a){$.extend(c,a),b.btnGoSearch.off().on("click",function(){if(_SL.validate(b.form))return 0==b.form.find("input:checkbox:checked").length?(alert("한개 이상을 선택하셔야 합니다."),void $("input[name=whois]").focus()):void e(!1)}),e(!0)},e=function(c){loading.show();var d,e,f,g,h,i;if(c)var j={search_ip:b.searchIp.val(),asset:b.asset.val()};else{d=b.searchIp.val(),g=b.whoisServer.val(),b.asset.is(":checked")&&(e=b.asset.val()),b.whois.is(":checked")&&(f=b.whois.val()),b.ping.is(":checked")&&(h=b.ping.val()),b.nmap.is(":checked")&&(i=b.nmap.val());var j={search_ip:d,whois_server:g,asset:e,whois:f,ping:h,nmap:i}}$("body").requestData(a.URL.urlIpcheck,j,{callback:function(a){loading.hide();var c=a.assetList,d=a.whoisInfo,e=a.pingInfo,f=a.nmapInfo;if(b.info.empty(),"EMPTY"==c)b.info.empty(),b.info.append("<b>[ 자산 ]</b><br>There is no Search Result<br><br>");else for(var g in c){var h=c[g],i=" ~ ";""!=h.eip&&(i+=h.eip),b.info.append("<b>[ 자산 ]</b><br>\t\t\t\t\t\t\t자산명 : "+h.asset_nm+"<br>\t\t\t\t\t\t\t자산 IP :"+h.sip+i+"<br>\t\t\t\t\t\t\t그룹 : "+h.group_nm+"<br>\t\t\t\t\t\t\t부서 : "+h.department+"<br>\t\t\t\t\t\t\t종류 : "+h.eqp_type_nm+"<br>\t\t\t\t\t\t\t중요도 : "+h.weight_nm+"<br>\t\t\t\t\t\t\t취약점 : "+h.weak_score_nm+"<br>\t\t\t\t\t\t\tOS : "+h.os+"<br>\t\t\t\t\t\t\t설명 : "+h.comments+"<br><br>")}null!=d&&b.info.append("<b>[ whois ]</b><br>"+d+"<br><br>"),null!=e&&b.info.append("<b>[ ping ]</b><br>"+e+"<br><br>"),null!=f&&b.info.append("<b>[ port-scan ]</b><br>"+f+"<br>"),b.form.parents(".nano").nanoScroller()}})};return{init:d}}(),$(function(){slapp.ip.check.init()});