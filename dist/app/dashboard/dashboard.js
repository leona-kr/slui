!function(a){"use strict";a.Dashboard={componentInstance:{},chartInstance:{},url:{dashboard_list:"/dashboard/dashboard_list.json",dashboard_tab_update:"/dashboard/dashboard_tab_update.do",dashboard_seq_update:"/dashboard/dashboard_seq_update.do",dashboard_detail:"/dashboard/dashboard_detail.json",dashboard_insert:"/dashboard/dashboard_insert.do",dashboard_update:"/dashboard/dashboard_update.do",dashboard_delete:"/dashboard/dashboard_delete.do",component_layout_update:"/dashboard/component_layout_update.do",component_list:"/dashboard/component_list.json",component_insert:"/dashboard/component_insert.do",component_update:"/dashboard/component_update.do",component_delete:"/dashboard/component_delete.do",share_list:"/dashboard/dashboard_share_list.json",user_list:"/common/user_list.json",report_list:"/dashboard/dashboard_report.do",load:"../component/load.do"},classname:{groupTab:"group-tab",groupTabs:"group-tabs",groupSide:"group-side",board:"group-board",btns:"group-topbutton",btnLink:"btn-tab",btnDelete:"btn-del",btnEdit:"btn-edit",btnSave:"btn-save",btnToggle:"btn-toggle",btnPrev:"btn-prev",btnNext:"btn-next",btnAdd:"btn-add",btnCancel:"btn-cancel",iconEdit:"icon-pencil",iconRemove:"icon-trash",iconSave:"icon-disk",iconCancel:"icon-times-circle",iconClose:"icon-times",iconLeft:"icon-chevron-left",iconRight:"icon-chevron-right",active:"active",disabled:"disabled",open:"open",selected:"selected",grid:"grid-bg",linecol:"line-col",linerow:"line-row",lineguide:"line-guide",title:"area-title",areaTime:"area-time",componentHead:"area-header",componentHeadsub:"area-header-side",componentClose:"btn-close",componentSetting:"btn-edit",componentBody:"area-body",componentInner:"inner-body",componentHover:"item-hover",modalAdd:"modal-dashboard-add"},msg:{empty:"생성된 대시보드가 없습니다.<br>대시보드를 생성해주세요",deleteDashboard:"대시보드를 삭제 하시겠습니까?",notAllowDelete:"한 개 이하의 대시보드는 삭제할 수 없습니다.",failComponent:"컴포넌트 추가에 실패하였습니다",inputInsertName:"추가하실 대시보드 이름을 입력해주세요",inputChangeName:"변경할 이름을 입력해 주세요"},optionsDefault:{grid_yn:"N",guide_yn:"Y",grid_col:2,margin:5,rowHeight:30},updateMonitoringTime:function(){this.refreshCount++,1440==this.refreshCount&&window.location.reload(),this.monitoringTime=_SL.formatDate.addSec(new Date,gTimeDiffFromServer,"yyyyMMddHHmmss"),a("."+this.classname.groupSide+" ."+this.classname.areaTime).text(this.getMonitoringTime("yyyy-MM-dd HH:mm:ss"))},getMonitoringTime:function(a){return _SL.formatDate(this.monitoringTime,"yyyyMMddHHmmss",a)},GRIDSTER:{},dashboardName:"",refreshTimer:{},refreshCount:0,dashboardInsert:function(){var b=this,c=a("."+b.classname.groupTab+" ."+b.classname.btnAdd),d=a("."+b.classname.modalAdd),e=function(c){var d=a(c.target);d.parents().hasClass(b.classname.modalAdd)||d.hasClass(b.classname.modalAdd)||d.parents().hasClass("modal-alert")||g()},f=function(){c.addClass(b.classname.active),d.find("input").val(""),d.fadeIn(200,function(){a(document).on("mousedown",e)})},g=function(){c.removeClass(b.classname.active),d.fadeOut(200,function(){a(document).off("mousedown",e)})},h=function(){var e="tab-item-active";d.find(".cont > div:eq(0)").css("display","block").end().find(".cont > div:eq(1)").css("display","none").end().find(".tab-group li").each(function(c){0===c?a(this).addClass(e):1===c&&a(this).removeClass(e),a(this).on("click",function(){a(this).addClass(e).siblings().removeClass(e),d.find(".cont > div").eq(c).css({height:"28px",display:"block"}).siblings().css("display","none"),slui.attach.setTransformSelect("."+b.classname.modalAdd)})}),c.on("click",function(){d.is(":hidden")?f():g()})},i=function(){var c="",e={},f=!1,h=function(a){g(),b.dashboardName=c,b.dashboardlist(a,c),b.dashboardConfig(!0),f=!1},i=function(){if(f=!0,d.find(".cont > div:eq(1)").is(":visible")){if("-1"===d.find(".cont > div:eq(1) option:selected").val())return!1;c=d.find(".cont > div:eq(1) option:selected").text(),e={dashboard_id:d.find(".cont > div:eq(1) select").val(),dashboard_name:d.find(".cont > div:eq(1) option:selected").text()},a("body").requestData(b.url.dashboard_insert,e,{callback:h})}else{if(c=d.find(".cont > div:eq(0) input").val().trim(),""==c)return _alert(b.msg.inputInsertName,{onAgree:function(){d.find(".cont > div:eq(0) input").focus()}}),!1;e={dashboard_name:d.find(".cont > div:eq(0) input").val()},a("body").requestData(b.url.dashboard_insert,e,{callback:h})}};d.find(".button button").on("click",i),d.find("input[type=text]").on("keyup",function(){13===event.keyCode?f||i():27===event.keyCode&&g()})},j=function(){var c=function(a){for(var b=d.find("select").empty().append('<option value="-1">선택하세요</option>'),c=0,e=a.length;c<e;c++)b.append('<option value="'+a[c].dashboard_id+'">'+a[c].dashboard_name+"</option>");i()};a("body").requestData(b.url.share_list,{},{callback:c})};j(),h()},dashboardDelete:function(b,c){var d=this,e=!0;(1===a("."+d.classname.groupTabs+" li").size()&&1===a("."+d.classname.groupTab+" li[data-id="+b+"]").size()||1===a("."+d.classname.groupTab+" li").size()&&1===a("."+d.classname.groupTab+" li[data-id="+b+"]").size())&&(e=!1,_alert(d.msg.notAllowDelete)),e&&_confirm(d.msg.deleteDashboard,{onAgree:function(){a("body").requestData(d.url.dashboard_delete,{dashboard_id:b},{callback:function(){a("."+d.classname.groupTabs+" li[data-id="+b+"]").remove(),d.dashboardlistUpdate(),"undefined"!=typeof c&&c(),a("."+d.classname.groupTab+" li[data-id="+b+"]").remove().promise().done(function(){var b=!0;a("."+d.classname.groupTab+" li."+d.classname.active).size()<1&&(b=!1),b||a("."+d.classname.groupTab+" li:eq(0) ."+d.classname.btnTab).click()})}})}})},dashboardlist:function(b,c){var d=this,e=[],f=[],g=a("."+d.classname.groupTab+" ul"),h=b,i=function(b){var c=a(b.target);c.parents().hasClass(d.classname.groupTabs)||c.hasClass(d.classname.groupTab)||c.parents().hasClass(d.classname.groupTab)||c.parents().hasClass(d.classname.btns)||c.parents().hasClass("modal-alert")||s()},j=function(){for(var a=0,b=h.length;a<b;a++)f.push({key:h[a].dashboard_seq,value:h[a]});f=m(f),p();for(var a=0,b=h.length;a<b;a++)"Y"==h[a].tab_yn&&e.push(h[a]);for(var c=[],a=0,b=e.length;a<b;a++)c.push({key:e[a].tab_seq,value:e[a]});if(e=m(c),n(),e.length>0)var i=e[0].dashboard_id;else var i=f[0].dashboard_id;k(i),g.parent().siblings("."+d.classname.btns).find("."+d.classname.btnToggle).off().on("mousedown",r)},k=function(b,c){a(".window.dashboardsetting").is(":visible")&&a(".window.dashboardsetting").hide(),d.chartInstance={},d.componentInstance={},a("body").requestData(d.url.dashboard_detail,{dashboard_id:b},{callback:function(e){d.dashboard_id=b,d.option=a.extend({},d.optionsDefault,{share_yn:e.share_yn,user_list:e.user_list,group_list:e.group_list,grid_yn:e.grid_yn,grid_col:e.grid_col,theme:isNaN(parseInt(e.dashboard_theme))?0:parseInt(e.dashboard_theme)}),l(),d.dashboardContent(e.component_list),1==c?d.dashboardConfig(!0):d.dashboardConfig()}})},l=function(){var b=""==d.option.theme?"basic":d.option.theme;a("#themeStyle").remove(),1===b?a("#dashboardStyle").after('<link rel="stylesheet" href="/resources/css/theme-blue.css" id="themeStyle">'):2===b&&a("#dashboardStyle").after('<link rel="stylesheet" href="/resources/css/theme-dark.css" id="themeStyle">')},m=function(a){a.sort(function(a,b){return a.key<b.key?-1:a.key>b.key?1:0});for(var b=[],c=0;c<a.length;c++)b.push(a[c].value);return b},n=function(c){var f=e,h=0;if(0===arguments.length){g.empty();for(var i=0,j=f.length;i<j;i++){var l=a("<li />").attr("data-id",f[i].dashboard_id).appendTo(g);a("<span />").addClass(d.classname.btnLink).text(f[i].dashboard_name).appendTo(l),a("<span />").addClass(d.classname.btnDelete).html('<i class="'+d.classname.iconClose+'"></i>').appendTo(l);i===h&&(l.addClass(d.classname.active),d.dashboardName=f[i].dashboard_name)}}else{g.find("."+d.classname.active).removeClass(d.classname.active);var m='<li data-id="'+b.dashboard_id+'" class="'+d.classname.active+'"><span class="'+d.classname.btnLink+'">'+c+'</span><span class="'+d.classname.btnDelete+'"><i class="'+d.classname.iconClose+'"></i></span></li>';g.prepend(m),d.dashboardlistUpdate(!0),k(b.dashboard_id,!0)}o(),d.dashboardlistArrow()},o=function(){var b;g.sortable({placeholder:"sortable-placeholder",axis:"x",stop:function(){d.dashboardlistUpdate(!0)},disabled:!0}),g.find("."+d.classname.btnLink).off().on("mouseenter",function(){b=setTimeout(function(){g.sortable("enable")},200)}).on("mouseleave",function(){clearTimeout(b),g.sortable("disable")}).on("click",function(){clearTimeout(b);var c=a(this).parents("li");k(c.attr("data-id"),!0),c.addClass(d.classname.active).siblings().removeClass(d.classname.active),d.dashboardName=a(this).text(),d.dashboardlistArrow()}).end().find("."+d.classname.btnDelete).off().on("mousedown",function(){if(a("."+d.classname.groupTab+" li").size()<2||a(this).parent().hasClass(d.classname.active))return!1;var b=a(this).parents("li");b.remove(),a("."+d.classname.groupTabs+" [data-id="+b.attr("data-id")+"]").removeClass(d.classname.disabled),d.dashboardlistUpdate(!0),d.dashboardlistArrow()})},p=function(c){var e=function(a){var b='<div class="tab-default">';return b+='<span class="'+d.classname.btnLink+'">'+a+"</span>",b+='<button type="button" class="'+d.classname.btnEdit+'"><i class="'+d.classname.iconEdit+'"></i></button>',b+='<button type="button" class="'+d.classname.btnDelete+'"><i class="'+d.classname.iconRemove+'"></i></button>',b+="</div>",b+='<div class="tab-edit">',b+='<input type="text" size="5">',b+='<button type="button" class="'+d.classname.btnSave+'"><i class="'+d.classname.iconSave+'"></i></button>',b+='<button type="button" class="'+d.classname.btnCancel+'"><i class="'+d.classname.iconCancel+'"></i></button>',b+="</div>"};if(0===arguments.length)for(var g=f,h=a("<div />").addClass(d.classname.groupTabs).css("display","none").appendTo(a("body")),i=a("<ul />").appendTo(h),j=0,k=g.length;j<k;j++){var l=a("<li />").attr("data-id",g[j].dashboard_id).appendTo(i).html(e(g[j].dashboard_name));"Y"==g[j].tab_yn&&l.addClass(d.classname.disabled)}else{var m='<li data-id="'+b.dashboard_id+'" class="'+d.classname.disabled+'">'+e(c)+"</li>";a("."+d.classname.groupTabs+" ul").prepend(m),d.dashboardlistUpdate()}q()},q=function(){var b,c="."+d.classname.groupTab+" ul",e=function(b,e,f){if(""==f.trim())_alert(d.msg.inputChangeName,{onAgree:function(){b.find("input[type=text]").focus()}});else{var g={dashboard_id:e,dashboard_name:f},h=function(){b.find("."+d.classname.btnLink).text(f),b.removeClass("mode-edit"),a(c+" li[data-id="+e+"]").find("."+d.classname.btnLink).text(f),d.dashboardName=f};a("body").requestData(d.url.dashboard_update,g,{callback:h})}};a("."+d.classname.groupTabs+" li").each(function(){var b=a(this),f=a(this).data("id");a(this).find("."+d.classname.btnLink).on("click",function(){k(f,!0);var e=d.classname.disabled,g=d.classname.active;if(b.hasClass(e)){var h=a("."+d.classname.groupTab).find("[data-id="+f+"]");h.addClass(g),h.siblings().removeClass(g)}else{var i=b.clone();b.addClass(e),i.html(i.find("."+d.classname.btnLink)).append('<span class="'+d.classname.btnDelete+'"><i class="'+d.classname.iconClose+'"></i></span>').addClass(g),a(c+" li").removeClass(g),a(c).prepend(i),d.dashboardlistArrow(),d.dashboardlistUpdate(!0),o()}}).end().find("."+d.classname.btnEdit).off().on("click",function(){var a=b.find("."+d.classname.btnLink).outerWidth(),c=b.find("."+d.classname.btnLink).text();b.addClass("mode-edit"),b.siblings().removeClass("mode-edit"),b.find("input").width(a+"px").attr("placeholder",c).val("").focus()}).end().find("."+d.classname.btnDelete).on("click",function(){var a=function(){d.dashboardlistUpdate()};d.dashboardDelete(f,a)}).end().find("."+d.classname.btnSave).on("click",function(){e(b,f,a(this).siblings("input[type=text]").val())}).end().find("."+d.classname.btnCancel).on("mousedown",function(){b.removeClass("mode-edit")}).end().find("input[type=text]").on("keydown keypress",function(c){13===c.keyCode?e(b,f,a(this).val()):27===c.keyCode&&b.removeClass("mode-edit"),c.stopPropagation()})}),a(window).on("resize",function(a){clearTimeout(b),b=setTimeout(function(){d.dashboardlistArrow()},500)})},r=function(){a("."+d.classname.groupTabs).is(":visible")?s():(a("."+d.classname.groupTabs+" li").removeClass("mode-edit"),a("."+d.classname.groupTabs).fadeIn(200,function(){a(document).on("mousedown",i)}),a("."+d.classname.btns+" ."+d.classname.btnToggle).addClass(d.classname.open))},s=function(){a("."+d.classname.groupTabs).fadeOut(300,function(){a(document).off("mousedown",i)}),a("."+d.classname.btns+" ."+d.classname.btnToggle).removeClass(d.classname.open)};1==arguments.length?h.length>0?j():a("."+d.classname.board).css({"text-align":"center",padding:"100px 0"}).html(d.msg.empty):2==arguments.length&&(n(arguments[1]),p(arguments[1]))},dashboardlistUpdate:function(b){for(var c=this,d=b===!0?c.url.dashboard_tab_update:c.url.dashboard_seq_update,e=a(b===!0?"."+c.classname.groupTab+" li":"."+c.classname.groupTabs+" li"),f=b===!0?"tab_seq":"dashboard_seq",g=[],h=0,i=e.size();h<i;h++){var j={};j.dashboard_id=e.eq(h).attr("data-id"),j[f]=h,g.push(j)}a("body").requestData(d,g,{callback:function(){a("."+c.classname.groupTab+" ."+c.classname.active).size()<1&&a("."+c.classname.groupTab+" li:eq(0) ."+c.classname.btnLink).click()}})},dashboardlistArrow:function(){var b=this,c=a("."+b.classname.btns),d=a("."+b.classname.groupTab),e=a("."+b.classname.groupTab+" ul"),f=d.width()-c.width()-a("."+b.classname.groupSide).width()-a("."+b.classname.groupTab+" ."+b.classname.btnAdd).width(),g=a("."+b.classname.groupTab+" ul").width(),h=b.classname.btnPrev,i=b.classname.btnNext,j=0,k=function(){if(g>f){if(c.find("."+h).size()>0||c.find("."+i).size()>0)return!1;var j=a("<button />").attr("type","button").prop("disabled",!0).html('<i class="'+b.classname.iconLeft+'"></i>').addClass(h),k=a("<button />").attr("type","button").html('<i class="'+b.classname.iconRight+'"></i>').addClass(i),l=!1,m=function(f){if(l)return!1;var g=d.width()-c.width()-a("."+b.classname.groupSide).width()-a("."+b.classname.groupTab+" ."+b.classname.btnAdd).width(),m=a("."+b.classname.groupTab+" ul").width(),o=g-m,p=parseInt(e.css("left"));if(f.currentTarget.className==h){if(p<0&&Math.abs(p)<=g){var q=0;j.prop("disabled",!0),k.prop("disabled",!1)}else if(0==p)k.prop("disabled",!1);else{var q=g;j.prop("disabled",!1)}n(q*-1)}else if(f.currentTarget.className==i){if(Math.abs(p)<=g){if(Math.abs(o)-Math.abs(p)<g){var q=Math.abs(o);k.prop("disabled",!0)}else{var q=g;k.prop("disabled",!1)}n(q*-1)}j.prop("disabled",!1)}},n=function(a){l=!0,e.animate({left:a},500,function(){l=!1})};c.prepend(k).prepend(j),j.off().on("mousedown",m),k.off().on("mousedown",m)}else(c.find("."+h).size()>0||c.find("."+i).size()>0)&&(c.find("."+h).remove(),c.find("."+i).remove())};setTimeout(function(){d.find("ul > li").each(function(){j+=a(this).outerWidth()}),d.find("ul").css("min-width",j+"px"),k(),a(window).on("resize",function(){k()})},20)},dashboardContent:function(c){var d,e,f,g,h,i,j=this,k=j.option,l=a("."+j.classname.board),m=l.attr("id"),n=function(){var a=window.innerWidth;g=parseInt(a/60),h=a%60,i=a-h},o=function(){clearTimeout(j.refreshTimer);var b=a("header").outerHeight()+a(".group-tab").outerHeight();l.html('<div class="'+j.classname.grid+'" id="gridarea'+m+'"></div><div id="boardarea'+m+'" class="nano-content" style="right:-17px;"></div>').addClass("nano").css({position:"fixed",top:b+"px",left:0,right:0,bottom:0}),d=a("#gridarea"+m),e=a("#boardarea"+m),"Y"===k.grid_yn&&p();var c="undefined"!=typeof gDashboardRefreshSecond?gDashboardRefreshSecond:60;j.updateMonitoringTime(),j.refreshTimer=setInterval(function(){j.updateMonitoringTime();for(var a in j.componentInstance)j.componentInstance[a].refreshComponent()},1e3*c),q(),s();var f;a(window).on("resize",function(a){n(),"Y"===j.option.grid_yn&&p(),clearTimeout(f),f=setTimeout(function(){q(!0)},500)})},p=function(){var b=j.option.grid_col,c=a("#gridarea"+m).show().empty(),d=function(){for(var b=0,d=(a(window).height()-90)/k.rowHeight;b<d;b++){a("<div />").addClass(j.classname.linerow).css("top",k.rowHeight*b).appendTo(c)}},e=function(){for(var d=1;d<60;d++){var e=a("<div />").addClass(j.classname.linecol).css("left",g*d).appendTo(c);if(d%(60/b)===0&&60!==d)for(var f=0;f<=b;f++)e.addClass(j.classname.lineguide)}};c.css({"margin-left":h/2+"px","margin-right":h/2+"px",width:i+"px"}),d(),e()},q=function(b){if(b)e.css({"margin-left":h/2+"px","margin-right":h/2+"px"}),j.GRIDSTER.resize_widget_dimensions({widget_base_dimensions:[g-2*k.margin,k.rowHeight-2*k.margin]}),setTimeout(function(){for(var a in j.componentInstance)if(j.componentInstance[a].$config.is(":visible")){var b=j.componentInstance[a].$config,c=j.componentInstance[a].$container;j.componentInstance[a].$config.css({left:j.getConfigPos(c,b).left+"px",top:j.getConfigPos(c,b).top+"px"})}},400),t();else{for(var c=a("<div />").addClass("gridster"),d=a("<ul />").appendTo(c),i=0,l=f.length;i<l;i++)d.append(r(f[i]));e.empty().css({"margin-left":h/2+"px","margin-right":h/2+"px"}),c.appendTo(e),j.GRIDSTER=d.gridster({widget_base_dimensions:[g-2*k.margin,k.rowHeight-2*k.margin],widget_margins:[k.margin,k.margin],max_size_x:60,helper:"clone",resize:{enabled:!0,min_size:[12,6],max_size:[60,60],start:function(){for(var a in j.componentInstance)j.componentInstance[a].$config.is(":visible")&&j.componentInstance[a].$config.hide()},stop:function(a,b,c){u(),c.find(".jqx-grid").size()>0&&c.find(".jqx-grid").resize(),t(),d.parents(".nano").nanoScroller()}},draggable:{handle:"."+j.classname.title,start:function(){for(var a in j.componentInstance)j.componentInstance[a].$config.is(":visible")&&j.componentInstance[a].$config.hide()},stop:function(a,b){u(),d.parents(".nano").nanoScroller()}}}).data("gridster"),v()}},r=function(b){var c=a("<li />").attr({"data-col":b.pos_x,"data-row":b.pos_y,"data-sizex":b.size_w,"data-sizey":b.size_h,"data-id":b.container_id,"data-label":b.label,id:"componentcontainer_"+b.container_id}),d=void 0==b.container_title?b.title:b.container_title,e=a("<div />").addClass(j.classname.componentHead).attr("id","componentheader_"+b.container_id).append('<div class="'+j.classname.title+'">'+d+"</div>").appendTo(c),f=a("<div />").addClass(j.classname.componentHeadsub).appendTo(e),g=(a("<button />").addClass(j.classname.componentClose).attr("type","button").html('<i class="'+j.classname.iconClose+'"></i>').appendTo(f),a("<button />").addClass(j.classname.componentSetting).attr("type","button").html('<i class="'+j.classname.iconEdit+'"></i>').appendTo(f),a("<div />").attr("id","componentbody_"+b.container_id).addClass(j.classname.componentBody).addClass("nano").appendTo(c));a("<div />").addClass("nano-content").addClass(j.classname.componentInner).data({dashboard_id:b.dashboard_id,container_id:b.container_id,compnent_id:b.component_id,component_type:b.component_type,component_path:b.component_path,component_title:b.component_title,component_param:b.component_param,config_param:b.config_param}).appendTo(g);return c.on("mouseover",function(){a(this).addClass(j.classname.componentHover)}).on("mouseout",function(){a(this).removeClass(j.classname.componentHover)}),c},s=function(c){if(0===arguments.length)a("."+j.classname.board+" ."+j.classname.componentBody+" ."+j.classname.componentInner).each(function(c){var d=a(this).data();a(this).load(j.url.load,d,function(){"undefined"!=typeof slapp.component&&"undefined"!=typeof slapp.component[d.component_type]&&(j.componentInstance[d.container_id]=new b(d.container_id,slapp.component[d.component_type](d.container_id,a.parseJSON(d.config_param),d.component_title,d.component_param)))})});else if(1===arguments.length&&"object"==typeof arguments[0]){var d=c,e=d.data();d.load(j.url.load,e,function(){u(),"undefined"!=typeof slapp.component&&"undefined"!=typeof slapp.component[e.component_type]&&(j.componentInstance[e.container_id]=new b(e.container_id,slapp.component[e.component_type](e.container_id,a.parseJSON(e.config_param),e.component_title,e.component_param)))})}},t=function(){a('style[generated-from="gridster"]').length>1&&a('style[generated-from="gridster"]').eq(0).remove()},u=function(b){if(void 0!=arguments[0])for(var c=0,d=f.length;c<d;c++)if(f[c].container_id===b){f.splice(c,1);break}var e=j.GRIDSTER.serialize();if(e.length!=f.length)return!1;for(var c=0,d=f.length;c<d;c++)f[c].pos_x=e[c].col,f[c].pos_y=e[c].row,f[c].size_w=e[c].size_x,f[c].size_h=e[c].size_y;for(var g=j.url.component_layout_update,h=f,c=0,d=h.length;c<d;c++)delete h[c].component_id,delete h[c].component_param,delete h[c].component_path,delete h[c].component_title,delete h[c].component_type,delete h[c].config_param,delete h[c].dashboard_id,delete h[c].title,delete h[c].label;a("body").requestData(g,h),v()},v=function(){a(".nano").nanoScroller(),a("#boardarea"+m).find("."+j.classname.componentClose).off().on("mouseup",function(){var b=a(this),c=b.parents("li"),d=c.attr("data-id"),e=function(){a("#config_"+d).remove(),u(d),"undefined"!=typeof j.componentInstance[d].destroy&&j.componentInstance[d].destroy(),void 0!=j.chartInstance[d]&&delete j.chartInstance[d],delete j.componentInstance[d]};j.GRIDSTER.remove_widget(b.parents("li"),function(){c.requestData(j.url.component_delete,{container_id:d},{callback:e})})})},w=function(b){for(var c=a("#componentaddlist").empty(),d=b,e=d.length,f=0;f<e;f++)if(""!==d[f].component_type){var g=a("<li />").appendTo(c);a("<span />").addClass("txt-item").text(d[f].component_title).appendTo(g),a("<button />").attr("type","button").attr("data-add-component","true").data(d[f]).addClass("btn-basic btn-apply").text("추가").appendTo(g).on("click",x)}a(".btn-addboard").off().on("click",function(){var b=".window.componentadd",c=function(){a(".btn-addboard").removeClass(j.classname.open),a(b).hide()},d=function(){a(".btn-addboard").addClass(j.classname.open),a(b).show().css({left:.5*(a(window).width()-a(b).width())+"px",top:.5*(a(window).height()-a(b).height())+"px"}).draggable({handle:".modal-head",containment:"body"}),a(b+" .nano").nanoScroller(),a(b+" .modal-head").css("cursor","move"),a(b+" .btn-close").one("click",c)};a(this).hasClass(j.classname.open)?c():d()})},x=function(){var b="Y"==j.optiongrid_yn?j.option.grid_col:12,c=a(this).data(),d=a.Dashboard.url.component_insert,e={pos_y:1,pos_x:1,size_w:b,size_h:12,dashboard_id:a.Dashboard.dashboard_id,component_id:a(this).data().component_id,title:c.component_title},g=function(b){var d={container_id:b.container_id,title:b.title,component_type:a(this).data("type"),config_param:b.config_param,label:b.label,pos_y:b.pos_y,pos_x:b.pos_x,size_w:b.size_w,size_h:b.size_h},e=r(d),g=20;f.push(d),"Y"===k.grid_yn&&"Y"===k.guide_yn&&(g=60/k.grid_col),j.GRIDSTER.add_widget(e,g,10,1,1);var h=a("#componentcontainer_"+b.container_id+" ."+j.classname.componentInner).data({dashboard_id:b.dashbard_id,container_id:b.container_id,compnent_id:c.component_id,component_type:c.component_type,component_path:c.component_path,component_title:c.component_title,component_param:c.component_param,config_param:b.config_param});s(h),v()};a("body").requestData(d,e,{callback:function(a){g(a)}})};"object"==typeof arguments[0]?(f=c,n(),o(),ComponentInfoList&&w(ComponentInfoList)):"boolean"==typeof arguments[0]&&(1==arguments[0]?(n(),p()):a("#gridarea"+m).hide())},dashboardConfig:function(b){var c=this,d=!1,e={name:"#setting_name",theme:"#setting_theme",grid:"#setting_grid",share:"#setting_share",switchOn:"btn-switch-on",switchOff:"btn-switch-off"},f=function(b,d){var f=a(e.share+" .layer-search-result:eq(1) ul").empty(),g=c.url.user_list,h=function(b){for(var c=0,e=b.length;c<e;c++){a("<li />").attr("data-id",b[c].user_id).attr("data-nm",b[c].user_nm).text("["+b[c].group_nm+"] "+b[c].user_nm+"("+b[c].user_id+")").appendTo(f)}o(),d()};a("body").requestData(g,b,{callback:h})},g=function(){a(".group-side .btn-setting").off().on("click",function(){var b=".window.dashboardsetting";if(a(b).show().css({left:.5*(a(window).width()-a(b).width())+"px",top:.5*(a(window).height()-a(b).height())+"px"}).draggable({handle:".modal-head",containment:"body"}),a(b+" .modal-head").css("cursor","move"),a(b+" .btn-close").one("click",function(){a(b).hide()}),h(),n(),d){if(a(e.shareUserLists+" .lists li").size()>0)return!1;f({})}slui.attach.setSwitchToggle(".dashboardsetting"),slui.attach.setTransformSelect(".dashboardsetting"),"Y"==c.option.share_yn&&a(".dashboardsetting .nano").nanoScroller(),o()}),a(".group-side .btn-report").off().on("click",function(){var b=a(".group-tab ul").find(".active"),d=a("<form>").attr({action:c.url.report_list});d.append(a("<input type='hidden' name='dashboard_id'>").val(b.data("id"))).append(a("<input type='hidden' name='dashboard_name'>").val(b.find(".btn-tab").text())).appendTo("body").submit().remove()})},h=function(){i(),j(),k(),l()},i=function(){a(e.name+" .name").text(c.dashboardName),a(e.name+" .text").show(),a(e.name+" .form").hide()},j=function(){var b=a(e.grid+" [data-switch-toggle=true]"),d=a(e.grid+" select"),f=a(e.grid+" .tform-select");"Y"===c.option.grid_yn?(b.val("1").addClass(e.switchOn).removeClass(e.switchOff),d.prop("disabled",!1).val(c.option.grid_col),f.removeClass("disabled")):(b.val("0").addClass(e.switchOff).removeClass(e.switchOn),d.prop("disabled",!0),f.addClass("disabled"))},k=function(){a(e.theme+" [name=dashboard_theme]:eq("+c.option.theme+")").prop("checked",!0)},l=function(){var b=a(e.share+" [data-switch-toggle=true]"),d=a(e.share+" .txt-search"),f=a(e.share+" .list"),g=a(e.share+" input"),h=a(e.share+" .btn-search");if("Y"===c.option.share_yn){var i=c.option.group_list,j=c.option.user_list;if(b.val("1").addClass(e.switchOn).removeClass(e.switchOff),d.removeClass("disabled"),f.removeClass("disabled"),g.prop("disabled",!1),h.prop("disabled",!1),i.length>0)for(var k=0,l=i.length;k<l;k++)m(0,i[k].group_cd,i[k].group_name);if(j.length>0)for(var k=0,l=j.length;k<l;k++)m(1,j[k].user_id,j[k].user_nm)}else b.val("0").addClass(e.switchOff).removeClass(e.switchOn),d.addClass("disabled"),f.addClass("disabled"),g.prop("disabled",!0),h.prop("disabled",!0),a(e.share).find(".nano").nanoScroller({destroy:!0}),a(e.share+" .list ul").empty()},m=function(b,c,d){if(a(e.share+" .list:eq("+b+") ul [data-id="+c+"]").size()>0||0!=b&&1!=b)return!1;var f=a(e.share+" .list:eq("+b+") ul"),g=a("<li />").appendTo(f),h=a("<button />").attr("type","button").addClass("btn-del").appendTo(g);a("<i />").addClass("icon-trash").appendTo(h);0===b?g.attr({"data-id":c,"data-nm":d}).append(d):1===b&&g.attr({"data-id":c,"data-nm":d}).append(d+"("+c+")"),h.on("click",function(){a(this).parent().remove()})},n=function(){var b=function(){a(e.name+" .text").show(),a(e.name+" .form").hide()},d=function(){a(e.name+" .text").hide(),a(e.name+" .form").show(),a(e.name+" .form input").attr("placeholder",a(e.name+" .name").text()).val("").focus().off().on("keydown",function(a){a.stopPropagation(),13==a.keyCode?f():27==a.keyCode&&b()})},f=function(){var d=a(e.name+" .form input").val().trim();if(""==d)_alert(c.msg.inputChangeName,{onAgree:function(){a(e.name+" .form input").focus()}});else{var f=function(){b(),a(e.name+" .name").text(d),a("."+c.classname.groupTab+" li[data-id="+c.dashboard_id+"] ."+c.classname.btnLink).text(d),a("."+c.classname.groupTabs+" li[data-id="+c.dashboard_id+"] ."+c.classname.btnLink).text(d),c.dashboardlistArrow()};s(d,f)}};a(e.name+" .name").on("dblclick",d),a(e.name+" .icon-pencil").on("click",d),a(e.name+" .icon-trash").on("click",function(){c.dashboardDelete(c.dashboard_id)}),a(e.name+" .icon-disk").on("click",f),a(e.name+" .icon-times-circle").on("click",b);var g="Y"===c.option.grid_yn,h=function(){1==g&&(c.option.grid_col=Number(a(e.grid+" select").val())),c.dashboardContent(g)};a(e.grid+" [data-switch-toggle=true]").off().on("click",function(){"0"===a(this).val()?(a(e.grid+" select").prop("disabled",!1),a(e.grid+" .tform-select").removeClass("disabled"),g=!0,c.option.grid_yn="Y"):"1"===a(this).val()&&(a(e.grid+" select").prop("disabled",!0),a(e.grid+" .tform-select").addClass("disabled"),g=!1,c.option.grid_yn="N"),s(g,h)}),a(e.grid+" select").on("change",function(){s(Number(a(this).val()),h)}),a(e.theme+" .btn-theme").on("click",function(){var b=a(e.theme+" [name=dashboard_theme]:checked").parents("[class*=range-]").index(),d=function(b){a("."+c.classname.groupTab+" ."+c.classname.active+" ."+c.classname.btnLink).click()};s(b+100,d)}),a(e.share+" [data-switch-toggle=true]").off().on("click",function(){"0"===a(this).val()?(a(e.share).find(".txt-search, .list").removeClass("disabled"),a(e.share).find(".btn-search, input[type=text]").prop("disabled",!1),a(e.share).find(".nano").nanoScroller()):"1"===a(this).val()&&(a(e.share).find(".txt-search, .list").addClass("disabled"),a(e.share).find(".btn-search, input[type=text]").prop("disabled",!0),a(e.share).find(".nano").nanoScroller({destroy:!0}))}),a(e.share+" .btn-search").each(function(b){a(this).on("click",function(){p(b)})}),a(e.share+" [type=text]").each(function(b){a(this).on("keydown",function(){switch(event.keyCode){case 13:p(b);break;case 27:q(),event.stopPropagation()}})}),a(e.share+" .btn-apply").on("click",function(){var b="1"==a(e.share+" [class^=btn-switch-]").val()?"Y":"N",c=[],d=[];a(e.share+" .list:eq(0) li").each(function(){c.push(String(a(this).data("id")))}),a(e.share+" .list:eq(1) li").each(function(){d.push(String(a(this).data("id")))});var f={share_yn:b,share_group_list:c,share_user_list:d},g=function(b,c,d){_alert(d),a(e.share+" [type=text]").val("")};s(f,g)})},o=function(){a(e.share+" .layer-search-result").each(function(b){var c=a(this);a(this).find("li").each(function(){a(this).off().on("click",function(){0===b?m(0,a(this).data("cd"),a(this).text()):1===b&&m(1,a(this).data("id"),a(this).data("nm")),c.hide(),a(e.share+" .nano").nanoScroller(),event.stopPropagation()})})})},p=function(b){var c=a(e.share+" [type=text]").eq(b).val(),g=a(e.share+" .layer-search-result").eq(b),h=g.find("li"),i=0,j=22,k=function(){0===i&&g.find("ul").append('<li class="empty">검색 결과가 없습니다</li>'),g.show().find(".nano").height(i*j+"px").nanoScroller(),a(document).on("mousedown",r)};if(g.find(".empty").remove(),d||1!==b){for(var l=0,m=h.size();l<m;l++)h.eq(l).text().indexOf(c)!=-1?(h.eq(l).css("display","block"),i++):h.eq(l).css("display","none");k()}else f({keyword:a(e.share+" [type=text]").eq(1).val(),recordstartindex:0,pagesize:50},function(){i=g.find("li").size(),k()})},q=function(){a(".layer-search-result").hide(),a(document).off("mousedown",r)},r=function(b){var c=a(b.target);c.parents().hasClass("layer-search-result")||c.siblings(".layer-search-result").is(":visible")||c.parents().hasClass("modal-alert")||q()},s=function(b,d){var f=c.url.dashboard_update,g=!1;switch(typeof b){case"string":var h={dashboard_id:c.dashboard_id,dashboard_name:b};break;case"number":if(b>=100)var h={dashboard_id:c.dashboard_id,dashboard_theme:String(b-100)};else var i="Y",h={dashboard_id:c.dashboard_id,grid_yn:"Y",grid_col:b};break;case"boolean":if(0==b)var i="N",h={dashboard_id:c.dashboard_id,grid_yn:i,grid_col:0};else var i="Y",h={dashboard_id:c.dashboard_id,grid_yn:i,grid_col:Number(a(e.grid+" select").val())};break;case"object":var h=b;h.dashboard_id=c.dashboard_id,g=!0}a("body").requestData(f,h,{callback:d,displayLoader:g})};"undefined"==typeof arguments[1]?g():arguments[1]===!0&&h()},getConfigPos:function(b,c){var d=this;if(b.position().left===d.optionsDefault.margin&&b.width()<c.width()){var e=b.position().left+b.find("."+d.classname.componentHeadsub).position().left;c.addClass("pos-left")}else{var e=b.position().left+b.width()-c.width();c.removeClass("pos-left")}if(b.outerHeight()+b.position().top>a("body").height()){var f=b.position().top-c.height();c.addClass("pos-bottom")}else{var f=b.position().top;c.removeClass("pos-bottom")}return{top:f,left:e}}};var b=function(b,c){if(0!==b.length){var d=this,e=a.Dashboard;d.classname={title:e.classname.title,config:"page-config-area",confighead:"modal-head",configtitle:"section-title",configpalette:"area-palette",configBottom:"area-bottom",btnApply:"btn-apply",btnCancel:"btn-cancel",
btnEdit:e.classname.btnEdit,iconCheck:"icon-checkmark",uiColor:"ui-color",selected:"selected",hold:"item-hold"},d.string={cancel:"취소",apply:"설정"},d.$container=a("#componentcontainer_"+b),d.$header=a("#componentheader_"+b),d.$title=a("#componentheader_"+b+" ."+d.classname.title),d.$config=a("#config_"+b),d.container_id=b,d.refreshTimer;var f=function(){a.extend(d,c),1===e.option.theme?d.chartstyles=a.extend({},slui.chart.chartConfig,d.chartStyle,d.chartColors.blue):2===e.option.theme?d.chartstyles=a.extend({},slui.chart.chartConfig,d.chartStyle,d.chartColors.dark):d.chartstyles=a.extend({},slui.chart.chartConfig,d.chartStyle,d.chartColors.basic),"undefined"!=typeof d.load&&d.load(),g(),setTimeout(function(){d.$container.find(".nano").nanoScroller()},1e3)},g=function(){for(var b='<div class="'+d.classname.configBottom+'"><button type="button" class="btn-basic '+d.classname.btnApply+'">'+d.string.apply+'</button><button type="button" class="btn-basic '+d.classname.btnCancel+'">'+d.string.cancel+"</button></div>",c="",e=0;e<4;e++)c+='<button type="button" class="'+d.classname.uiColor+'" data-value="'+e+'"><i class="'+d.classname.iconCheck+'"></i></button>';var f=a("<div />").addClass(d.classname.confighead);a("<div />").addClass(d.classname.configtitle).html("<h4>"+d.component_title+"</h4>").appendTo(f),a("<div />").addClass(d.classname.configpalette).appendTo(f).html(c);d.$config.find(".modal-body").before(f),d.$config.find(".modal-body").append(b),i(),h()},h=function(){var c=(a("#componentheader_"+b+" ."+d.classname.title),void 0!=d.title?d.title:d.component_title);d.$title.html(c)},i=function(){var b=d.$header.find("."+d.classname.btnEdit),c=d.$config.find("."+d.classname.btnApply),f=d.$config.find("."+d.classname.btnCancel),g=d.$config.find("."+d.classname.uiColor),h=parseInt(d.$container.attr("data-label"));0===d.$config.length?b.remove():(d.$config.appendTo(a(".gridster")),b.on("click",function(){d.$config.css({left:e.getConfigPos(d.$container,d.$config).left+"px",top:e.getConfigPos(d.$container,d.$config).top+"px"}).fadeIn(200,function(){d.$container.addClass(d.classname.hold),slui.attach.init("#config_"+d.container_id)}),k()}),c.on("click",function(){m()}),f.on("click",function(){l()}),g.each(function(){a(this).data("value")===h&&a(this).addClass(d.classname.selected).siblings().removeClass(d.classname.selected),a(this).on("click",function(){a(this).addClass(d.classname.selected).siblings().removeClass(d.classname.selected),m(Number(a(this).attr("data-value")))})}))},j=function(b){var c=a(b.target);c.parents().hasClass(d.classname.config)||c.hasClass(d.classname.config)||c.parents().hasClass("ui-datepicker")||c.parents().hasClass("modal-alert")||l()},k=function(){d.isOpenConfig=!0,"undefined"!=typeof d.showConfig&&d.showConfig(),a(document).on("mousedown",j)},l=function(){d.isOpenConfig=!1,d.$config.fadeOut(200),d.$container.removeClass(d.classname.hold),a(document).off("mousedown",j),"undefined"!=typeof d.cancelConfig&&d.cancelConfig()},m=function(a){var c=e.url.component_update;if(1===arguments.length&&"number"==typeof arguments[0])var f={label:a,container_id:b},g=function(){d.$container.attr("data-label",a)};else{var g=function(){l(),d.afterSaveConfig(),setTimeout(function(){d.$container.find(".nano").nanoScroller()},1e3)};if(d.validateConfig){if(!d.validateConfig())return!1}else if(!_SL.validate(d.$config))return!1;d.beforeSaveConfig();var f={container_id:d.container_id,title:d.title,config_param:JSON.stringify(d.config_param)}}d.$container.requestData(c,f,{callback:g})};f()}};b.prototype={isOpenConfig:!1,isFrequentRefresh:!1,beforeSaveConfig:function(){var a=this.$config.find("form").serializeArray();this.config_param={};for(var b=0,c=a.length;b<c;b++)this.config_param[a[b].name]=a[b].value},afterSaveConfig:function(){var a=this;a.refresh(!0)},refreshComponent:function(){var a=this;if(0==a.isOpenConfig&&"undefined"!=typeof a.refresh)if(a.isFrequentRefresh){var b=0,c=function(){a.refresh(!0),5==b&&clearInterval(a.refreshTimer),b++},d="undefined"!=typeof gDashboardMinRefreshSecond?gDashboardMinRefreshSecond:10;a.refreshTimer=setInterval(c,1e3*d)}else a.refresh(!0)},chartStyle:{alternateHGridAlpha:"0",alternateVGridAlpha:"0",labelFontSize:"10",plotfillalpha:"100"},chartColors:{basic:{top5Colors:"#89cf43,#dddddd,#dddddd,#dddddd,#dddddd,#dddddd,#dddddd,#dddddd,#dddddd,#dddddd",unitColor:"#89cf43",baseFontColor:"#000000",outCnvBaseFontColor:"#000000",bgColor:"#fefefe",borderColor:"#f2f2f2",canvasBgColor:"#fefefe",divLineColor:"#f2f2f2",legendBgColor:"#fefefe",plotBorderColor:"#000000",toolTipColor:"#ffffff",toolTipBgColor:"#000000"},dark:{top5Colors:"#669933,#4b4b4b,#4b4b4b,#4b4b4b,#4b4b4b,#4b4b4b,#4b4b4b,#4b4b4b,#4b4b4b,#4b4b4b",unitColor:"#669933",baseFontColor:"#eeeeee",outCnvBaseFontColor:"#999999",bgColor:"#222222",borderColor:"#eeeeee",canvasBgColor:"#222222",divLineColor:"#333333",legendBgColor:"#222222",plotBorderColor:"#353535",toolTipColor:"#ffffff",toolTipBgColor:"#000000",valueFontColor:"#ffffff"},blue:{top5Colors:"#0099ff,#17239f,#17239f,#17239f,#17239f,#17239f,#17239f,#17239f,#17239f,#17239f",unitColor:"#0099ff",baseFontColor:"#0099ff",outCnvBaseFontColor:"#0099ff",bgColor:"#000139",borderColor:"#eeeeee",canvasBgColor:"#000139",divLineColor:"#1b2f7f",legendBgColor:"#000139",plotBorderColor:"#000d94",toolTipBorderThickness:"1",toolTipColor:"#ffffff",toolTipBgColor:"#000000",valueFontColor:"#ffffff"}}},window.Component=b}(jQuery),$(function(){$("body").requestData($.Dashboard.url.dashboard_list,{},{callback:function(a){$.Dashboard.dashboardlist(a)}}),$.Dashboard.dashboardInsert()});