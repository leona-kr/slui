"use strict";var goCollectView=function(a,b){var c=gCONTEXT_PATH+"monitoring/collect_info_view.html?&s_eqp_ip="+a+"&period="+b;window.open(c,"collectView"+(new Date).getTime())};_SL.nmspc("slapp.component").collect_status=function(a,b,c){var d=a,e=b,f=c,g="chart-inner-container-"+d,h=gCONTEXT_PATH+"component/collect_status.json",i=$("#chart-container-"+d),j=(i.find("#chart-inner-container-"+d),$("#config_"+d+" form")),k=j.find("[name=eqp_ip]"),l=j.find("[name=eqp_ip_list]"),m=j.find("[name=log_cate_cd]"),n=j.find("[name=chart_type]"),o=j.find("[name=last_period]"),p=(j.find("[name="+d+"_eqp_ip]"),j.find("[name="+d+"_eqp_ip_list]"),j.find("[name="+d+"_log_cate_cd]"),j.find("[name="+d+"_chart_type]"),j.find("[name="+d+"_last_period]"),{last_period:"30",col_opt:"equip",agent_ip:"",eqp_ip_list:"",log_cate_cd:"",chart_type:"A"}),q=function(a){a===!0?r(a):(this.title=f,this.config_param=e=$.extend({},p,e),s.dataSource.chart=$.extend(this.chartstyles,t),j.on("click",".btn-add",function(){var a=k.find(":selected").val(),b=k.find(":selected").text();return l.find("option").size()>10?void _alert("최대 10개까지만 선택가능합니다."):""==a?void _alert("장비를 선택하세요."):l.find("option").is(function(){return this.value==a})?void _alert("동일한 장비가 존재합니다."):void l.append(new Option(b,a))}).on("click",".btn-del",function(){l.find(":selected").remove()}),FusionCharts&&(FusionCharts.items[d+"_id"]=null,delete FusionCharts.items[d+"_id"]),k.chosen({search_contains:!0,width:"100%",max_selected_options:10}),r())},r=function(a){var b=e.eqp_ip_list.split(",");if(""!=e.eqp_ip_list&&b.length>0){var c,f=function(){var a=e.last_period,b=[];for(a;a>0;a--)c=_SL.formatDate.addMin(g,a*-1),b.push(_SL.formatDate(c,"MM-dd HH:mm"));var d=[],f=[];for(var h in b)d.push({label:b[h]}),f.push({value:0});s.dataSource.categories=[],s.dataSource.categories.push({category:d})},g=_SL.formatDate(),i=u[e.chart_type],j=$.extend({curDate:(new Date).getTime()},e),k=function(c){var g,h=[],j=e.last_period;f();for(var k in b){var l=[];g=b[k];var m=c[g];if(null!=m)for(var n in m)l.push({value:m[n].value,link:'javascript:goCollectView("'+g+'","'+j+'")'});else for(var n=0;n<j;n++)l.push({value:0,link:'javascript:goCollectView("'+g+'","'+j+'")'});h.push({seriesname:g,data:l})}s.dataSource.dataset=h,a===!0&&void 0!=$.Dashboard.chartInstance[d]?($.Dashboard.chartInstance[d].chartType(i),$.Dashboard.chartInstance[d].setJSONData(s.dataSource)):FusionCharts.ready(function(){$.Dashboard.chartInstance[d]=new FusionCharts(s).render()})};s.type=i,"msarea"==s.type&&(s.dataSource.chart.plotfillalpha="60"),f(),$("body").requestData(h,j,{callback:k})}else{var l=[];s.dataSource.categories=[],s.dataSource.dataset=[],s.dataSource.categories.push({category:l}),a===!0&&void 0!=$.Dashboard.chartInstance[d]?$.Dashboard.chartInstance[d].setJSONData(s.dataSource):FusionCharts.ready(function(){$.Dashboard.chartInstance[d]=new FusionCharts(s).render()})}},s={type:"msarea",renderAt:g,width:"100%",height:"200",dataFormat:"json",dataSource:{chart:t,categories:[],dataset:[]}},t={caption:"",subCaption:"",xAxisName:"",yAxisName:"",numberPrefix:"",showValues:"0"},u={A:"msarea",L:"msline",C:"mscolumn2d",S:"stackedcolumn2d"},v=function(){k.html('<option value="">[선택하세요]</option>'),l.empty();var a=e.eqp_ip_list,b=a.split(",");for(var c in EquipList){var d=EquipList[c];k.append('<option value="'+d.eqp_ip+'">'+d.eqp_nm+"["+d.eqp_ip+"]</option>");for(var c in b){var f=b[c];f==d.eqp_ip&&l.append('<option value="'+d.eqp_ip+'">'+d.eqp_nm+"["+d.eqp_ip+"]</option>")}}k.trigger("chosen:updated"),m.html('<option value="">[전체]</option>');for(var c in LogCategoryList){var g=LogCategoryList[c];m.append('<option value="'+g.code_id+'">'+g.code_name+"</option>")}m.val(e.log_cate_cd),n.val(e.chart_type),o.val(e.last_period)},w=function(){return""!=n.val()||(_alert("차트를 선택하세요."),!1)},x=function(){var a=$.map(l.find("option"),function(a,b){return a.value}),b=m.val(),c=n.val(),d=o.val();e.eqp_ip_list=a.join(","),e.log_cate_cd=b,e.chart_type=c,e.last_period=d},y=function(){r(!0)};return{containerId:d,config_param:e,component_title:f,load:q,refresh:r,showConfig:v,validateConfig:w,beforeSaveConfig:x,afterSaveConfig:y}};