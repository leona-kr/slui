"use strict";_SL.nmspc("slapp.component").search_stats_top=function(a,b,c){var d=a,e=$("#componentheader_"+d),f=$("#componentbody_"+d),g=$("#config_"+d+" form"),h=f.find(".grid-table-group"),i=(f.find(".chart-group"),e.find(".area-title")),j=g.find("[name=last_period]"),k=g.find("[data-name=group_field]"),l=g.find("[name=rows]"),m=(g.find("[name=list_yn]"),gCONTEXT_PATH+"sysdata/comcode_map.json",gCONTEXT_PATH+"component/top_stats_mng_use_list.json"),n=gCONTEXT_PATH+"component/top_stats_data_1h.json",o=gCONTEXT_PATH+"monitoring/log_search.html",p={last_period:"10080",rows:"5",list_yn:"N",top_code:"",item_seq:"",field_nm:"",time_reference:"",start_time:"",end_time:""},q=b,r=c,s=null,t=null,u=null,v=function(){this.config_param=q=$.extend({},p,q),B=$.extend(this.chartstyles,B),B.paletteColors=B.top5Colors,q.time_reference="",A(),w()},w=function(a){var b=function(b){s=b,q.time_reference=b.end_time,q.start_time=b.start_time,q.end_time=b.end_time;var c,e=[],f=[],j="COUNT";if(null!=b.top_item_mng){var k=b.top_item_mng;t=e=k.group_fields.split(",");for(var l in e)f[l]=LogCaptionInfo[e[l]];if(c=f.join(","),j=k.func.toUpperCase(),"count"!=k.func){var m=LogCaptionInfo[k.field_nm]?LogCaptionInfo[k.field_nm]:k.field_nm;j+="("+m+")"}B.xAxisName=c,B.yAxisName=j}var n="";if(null!=c){var o=g.find("[name=last_period]").find("[value="+q.last_period+"]");n=b.top_mng.top_name+"/"+c+" 순위 ["+o.text()+"]",i.text(n)}if("N"==q.list_yn)h.hide();else{var p=h.find("thead").empty(),r=h.find("tbody").empty(),u="<tr>";u+='<th scope="col">순위</th>';for(var v in f)u+='<th scope="col">'+f[v]+"</th>";if(u+='<th scope="col">'+j+"</th>",u+='<th scope="col">비율</th>',u+="</tr>",p.html(u),0==b.list.length){var w=p.find("th").size();r.html('<tr><td colspan="'+w+'" class="list-empty">There is no Result.</td></tr>')}else{for(var x=0,l=0,y=b.list.length;l<y;l++){var z='javascript:$.Dashboard.componentInstance["'+d+'"].goSearchPopup("'+b.start_time+'","'+b.end_time+'","'+l+'")',A="<tr>";A+="<td>"+(l+1)+"</td>";for(var v in e)A+="<td><a href='"+z+"'>"+b.list[l][e[v]]+"</a></td>";A+="<td>"+_SL.toComma(b.list[l].value)+"</td>",A+=0==b.total?"<td>"+_SL.formatNumber(b.total)+"%</td>":"<td>"+_SL.formatNumber({decimals:2},b.list[l].value/b.total*100)+"%</td>",A+="</tr>",r.append(A),x+=b.list[l].value,b.list[l].link=z}var C=b.total-x;if(C>0){var D="<tr>";D+="<td>기타</td>";for(var v in e)D+="<td></td>";D+="<td>"+_SL.toComma(C)+"</td>",D+="<td>"+_SL.formatNumber({decimals:2},C/b.total*100)+"%</td>",D+="</tr>",r.append(D)}}h.show()}a===!0&&void 0!=$.Dashboard.chartInstance[d]?$.Dashboard.chartInstance[d].setJSONData({chart:B,data:b.list}):FusionCharts.ready(function(){$.Dashboard.chartInstance[d]=new FusionCharts({type:"bar2d",renderAt:"chart-container_"+d,width:"100%",height:"5"==q.rows?220:260,dataFormat:"json",dataSource:{chart:B,data:b.list}}).render()})};q.item_seq&&$("body").requestData(n,q,{callback:b})},x=function(){j.val(q.last_period),l.val(q.rows),g.find("[name=list_yn]:input[value="+q.list_yn+"]").prop("checked",!0),k.dynatree("getTree").activateKey(q.top_code+"|"+q.item_seq)},y=function(){q.group_field=k.val(),q.last_period=j.val(),q.rows=l.val(),q.list_yn=g.find("[name=list_yn]:checked").val();var a=k.dynatree("getTree").getActiveNode();if(a){var b=a.data.key;q.top_code=b.split("|")[0],q.item_seq=b.split("|")[1]}},z=function(){w(!0)},A=function(){var a=function(a,b,c){var d,e,f,g=null,h=[];for(var i in a.topMngGroupFieldUseList){d=a.topMngGroupFieldUseList[i],e=d.top_name,f=d.group_feild==q.field_nm,null!=g&&g.title==e||(g={title:e,isFolder:!0,children:[]},h.push(g)),f&&(g.expand=!0);var j=d.group_field.split(",");for(var l in j)j[l]=LogCaptionInfo[j[l]];g.children.push({title:d.item_seq-1+"."+j.join(",")+"("+d.func.toUpperCase()+")["+d.group_field+"]",tooltip:d.item_seq-1+"."+j.join(",")+"["+d.group_field+"]",key:d.top_code+"|"+d.item_seq})}k.dynatree({minExpandLevel:1,clickFolderMode:2,autoCollapse:!0,children:h}),u=k.dynatree("getTree")};$("body").requestData(m,{},{callback:a})},B={caption:"",subCaption:"",numberPrefix:""},C=function(a,b,c){var d,e="";for(var g in t)d=s.list[c][t[g]],""!=e&&(e+=" AND "),e+="-"==d?"NOT "+t[g]+":*":t[g]+":"+_SL.luceneValueEscape(d);e+=" AND ("+s.top_mng.search_condition+")";var h=f.find("[name=logSearchForm]");$("[name=start_time]",h).val(a),$("[name=end_time]",h).val(b),$("[name=expert_keyword]",h).val(e);var i="logSearchWin_"+(new Date).getTime();h.attr({action:o,target:i,method:"post"}).submit()};return{config_param:q,component_title:r,load:v,refresh:w,showConfig:x,beforeSaveConfig:y,afterSaveConfig:z,goSearchPopup:C}};