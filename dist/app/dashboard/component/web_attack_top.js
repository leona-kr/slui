"use strict";_SL.nmspc("slapp.component").web_attack_top=function(a,b,c){var d=a,e=($("#"+d+"_inner_container"),$("#"+d+"_inner_container .goSmsView"),$("#componentbody_"+d)),f=$("#config_"+d+" form"),g=gCONTEXT_PATH+"component/web_attack_top_list.json",h=gCONTEXT_PATH+"event2/eps_security_event_list.html",i=$("#config_"+d+" .btn-apply"),j={last_period:"1440",rows:"5",start_time:""},k=b,l=c,m=function(){this.title=l,this.config_param=k=$.extend({},j,k),p(),s(),r()},n=function(){f.off().on("click",i,function(){k=$.extend({},_SL.serializeMap(f)),p(),s(),r()}),e.find(".grid-table-group tbody").find("[class*=color_ec]").off().on("click",function(){var a=$(this),b=a.data("s_src_ip"),c="1",d=a.data("s_event_cate_cd"),f=e.find("[name=webAttackTopForm]");$("[name=s_src_ip]",f).val(b),$("[name=s_tc_type]",f).val(c),$("[name=s_event_cate_cd]",f).val(d);var g="webAttackTopFormWin_"+(new Date).getTime();f.attr({action:h,target:g,method:"post"}).submit()}),$(".toolkitImg").each(function(){$(this).on("click",function(){o($(this).attr("data-ip"))})})},o=function(a){$("#hiddenIFrame").attr("src","/monitoring/va_toolkit.do?"+$.param({start_time:$("[name=start_time]").val(),end_time:$("[name=end_time]").val(),expert_keyword:"",src_ip:a,tc_type:1}))},p=function(){var a=e.find(".grid-table-group tbody"),b=e.find(".grid-table-group thead");a.empty(),b.empty(),a.children().remove(),k=k=$.extend({},j,k),$("body").requestData(g,k,{callback:function(c){var d=c.rsList,e=c.eventCates;$("[name=start_time]").val(c.start_time),$("[name=end_time]").val(c.end_time),b.append("<th scope='col'>HOST</th>");for(var f in e){var g=d[f],h="";h+="<th scope='col'>",h+="<span>",h+=1*f+1+"단계",h+="</span><br>("+e[f].code_name+")",b.append(h)}if(b.append("<th scope='col'>위험도</th>"),0==d.length){var i=$("<tr>");i.append($("<td colspan='8'> 검색 결과가 없습니다. </td>")),i.appendTo(a)}for(var f in d){var g=d[f],i=$("<tr>");i.append($("<td>"+g.src_ip+"</td>"));for(var j in e){var k=g["cate"+(1*j+1)+"_cnt"],l=$("<td>");l.append(k),0!=k&&l.attr("tabindex","1").addClass("color_ec"+(1*j+1)).data("s_src_ip",g.src_ip).data("s_event_cate_cd",1*j+1),l.appendTo(i)}var m="";m+="<td>"+g.risk_score+"%",m+="&nbsp; <button type='button' class='text-purple icon-download-square toolkitImg' data-ip='"+g.src_ip+"'></button>",m+="</td>",i.append($(m)),i.appendTo(a)}n()}})},q=function(){p()},r=function(){k.rows&&$("#config_"+d+" [name=rows] option").each(function(){$(this).val()==k.rows&&$(this).attr("selected",!0)})},s=function(){};return{config_param:k,component_title:l,load:m,refresh:q}};