"use strict";_SL.nmspc("DetailAndWrite").mode,_SL.nmspc("DetailAndWrite").boardName,_SL.nmspc("DetailAndWrite").boardType,_SL.nmspc("DetailAndWrite").boardIndex,_SL.nmspc("board").DetailAndWrite=function(){var a=0,b={formId:$("#detailAndWriteform")},c=function(){$(".multi-file").MultiFile({STRING:{remove:'<button type="button" class="btn-basic btn-xs icon-times" title="삭제">'}}),$("form").keypress(function(a){"13"==a.which&&_SL.enterNext()}),$("#comet_cont").keyup(function(){var a=1e3;return $("#comet_cont").val().length>a?(this.value=this.value.substring(0,a),!1):void $("#textlength").text($("#comet_cont").val().length)}),j($("#YnChk").val()),0==$(".area-list li").size()?$(".area-list").hide():$(".area-list").show(),p(),$(".write-save").on("click",function(){m()}),$(".btn-submit").on("click",function(){i()}),$("td .filedown").on("click",function(){o($(this).attr("data-fileSeq"))}),slui.attach.setTransformSelect(b.formId),d()},d=function(){$(".area-list").on("click"," .btn-delete",function(){var a=$(this);_confirm("댓글을 삭제하시겠습니까?",{onAgree:function(){var b=a.attr("data-comment_no");$("#comment_no").val(b),$("body").requestData("/board/DeleteCommon.do",_SL.serializeMap($("form")),{callback:function(b,c,d){"SUC_COM_0000"==c?($("#comment_no").val(""),$(a).parent().parent().remove(),$(".tit").text("댓글("+b.comment_size+")")):_alert("저장 처리중 에러가 발생했습니다.<br>다시 실행하세요.")}})}})}),$("#btn-detail-delete").on("click",function(){l()}),$("#btn-detail-modify").on("click",function(){g()}),$("#btn-detail-list").on("click",function(){k()}),$("#btn-detail-write").on("click",function(){h()}),$("#comet_cont").keyup(function(a){var b=$(this).val();$(".txt-cnt").html("("+b.length+"/1000)")}),$(".write-cancel").on("click",function(){k()}),$("#timeSet").change(function(){var a=this.value,b=_SL.formatDate("yyyyMMdd");if(0==a)$("#popup_expire_dt").val("");else{var c=_SL.formatDate.addMin(b+"0000",a);$("#popup_expire_dt").val(c.substring(0,8))}}),$("#popup_expire_dt").change(function(){$("#timeSet").val(0)}),$("#popup_timeSet").hide(),$("#popup_date").hide(),$("#popup_label").hide(),$("#popup_check").change(function(){"N"==$("#popup_check").val()?($("#popup_timeSet").hide(),$("#popup_date").hide(),$("#popup_label").hide()):($("#popup_timeSet").show(),$("#popup_date").show(),$("#popup_label").show(),slui.attach.setTransformSelect("#popup_timeSet"))})},e=function(a,b){$(a).val(b)},f=function(){document.form;if(_SL.validate()){if("Y"==$("#popup_check").val()&&""!=$.trim($("#popup_expire_dt").val())){var a=_SL.formatDate("yyyyMMdd"),b=$.trim($("#popup_expire_dt").val()),c=/^\d{4}(0[1-9]|1[0-2])(0[1-9]|[1,2][0-9]|3[0,1])$/;if(!c.test(b))return void _alert("팝업의 만료일자가\n올바른 날짜 형식(yyyyMMdd)이 아닙니다.");if(a>b)return void _alert("팝업의 만료일이\n현재시간보다 작습니다.")}var d=q($("#bd_subject").val()),e=n(d);$("#bd_subject ").val(""),$("#bd_subject ").val(e),oEditors.getById.bd_cont.exec("UPDATE_CONTENTS_FIELD",[]),$(".write-save").on("click",function(){m()}),$("#detailAndWriteform")[0].action="/board/modifySave.do",$("#detailAndWriteform").submit()}},g=function(){oEditors.getById.bd_cont.setIR($("#bd_cont_temp").val()),e($("#bd_subject"),$("#modifysubject").text().trim()),$("body").requestData("/board/BoardModify.json",_SL.serializeMap($("form")),{callback:function(b,c,d){var e=b;if("SUC_COM_0000"==c){$("#writeform > table").find("tr").eq(1).after("<tr><th>기존파일</th><td id='listFiles'></td></tr>");for(var f in e)if("Filelist"==f)for(var g in e.Filelist)$("#listFiles").append("<span id='span_"+e.Filelist[g].bf_seq+"'>"+e.Filelist[g].org_name+"</span> <button type='button' class='btn-basic btn-xs icon-times' title='삭제' alt='"+e.Filelist[g].bf_seq+"' ></button><br>");$("#listFiles").on("click","button",function(){var b=$(this).attr("alt");0==a?($("#fileDeleteList").val($(this).attr("alt")),a++):$("#fileDeleteList").val($("#fileDeleteList").val()+","+$(this).attr("alt")),$(this).remove(),$("#span_"+b).remove()}),""!=b.BoardList[0].popup_expire_dt&&($("#popup_timeSet").show(),$("#popup_date").show(),$("#popup_label").show(),$("#popup_expire_dt").val(b.BoardList[0].popup_expire_dt)),slui.attach.setTransformSelect("table")}else _alert("저장 처리중 에러가 발생했습니다.<br>다시 실행하세요.")}}),$("#divform1").hide(),$("#divform2").show(),$("#writeform").show(),$("#Detailform").hide(),$(".write-save").on("click",function(){f()})},h=function(){$("#writeChk").val("Y"),$("#StartChk").val(""),$("#detailAndWriteform")[0].action="/board/goDetailAndWrite.html",$("#detailAndWriteform").submit()},i=function(){if(""==$("#comet_cont ").val()||"undefined"==typeof $("#comet_cont ").val())return!1;var a=q($("#comet_cont ").val()),b=n(a);$("#comet_cont ").val(""),$("#comet_cont ").val(b),$("body").requestData("/board/goComentSave.json",_SL.serializeMap($("form")),{callback:function(a,b,c){if("SUC_COM_0000"==b){$(".tit").text("댓글("+a.length+")"),$(".area-list ul").empty(),$(".area-list").show();for(var d in a){var e=a[d],f="YES"==e.YN||"1"==$("#role_id")?"<button type='button' class='btn-basic btn-xs btn-delete' data-comment_no="+e.comment_no+">삭제</button>":"";$(".area-list ul").append("<li><div class='sp-info'>"+e.user_nm+e.reg_dt+f+"</div><div class='data_div sp-text'>"+e.comment_cont+"</div></li>")}$("#comet_cont").val("")}else _alert("저장 처리중 에러가 발생했습니다.<br>다시 실행하세요.")}})},j=function(a){"Y"==a?($("#writeform").show(),$("#Detailform").hide()):($("#writeform").hide(),$("#Detailform").show())},k=function(){$("form:first").attr({method:"POST",action:"/board/board_view.html"}).submit()},l=function(){_confirm("해당글을 삭제하시겠습니까?",{onAgree:function(){$("#detailAndWriteform")[0].action="/board/BoardDelete.do",$("#detailAndWriteform").submit()}})},m=function(){document.form;if(_SL.validate($("#detailAndWriteform"))){if("Y"==$("#popup_check").val()&&""!=$.trim($("#popup_expire_dt").val())){var a=_SL.formatDate("yyyyMMdd"),b=$.trim($("#popup_expire_dt").val()),c=/^\d{4}(0[1-9]|1[0-2])(0[1-9]|[1,2][0-9]|3[0,1])$/;if(!c.test(b))return void _alert("팝업의 만료일자가\n올바른 날짜 형식(yyyyMMdd)이 아닙니다.");if(a>b)return void _alert("팝업의 만료일이\n현재시간보다 작습니다.")}var d=q($("#bd_subject").val()),e=n(d);$("#bd_subject ").val(""),$("#bd_subject ").val(e),oEditors.getById.bd_cont.exec("UPDATE_CONTENTS_FIELD",[]),$("#detailAndWriteform")[0].action="/board/goSave.do",$("#detailAndWriteform").submit()}},n=function(a){var b=a;return b=b.replace(/<(\/)?[Ss][Cc][Rr][Ii][Pp][Tt](\/)?>/g,""),b=b.replace(/<(\/)?[Jj][Aa][Vv][Aa][Ss][Cc][Rr][Ii][Tt](\/)?>/g,""),b=b.replace(/[Dd][Oo][Cc][Mm][Ee][Nn][Tt][.][Cc][Oo][Oo][Kk][Ii][Ee]/g,""),b=b.replace(/<(\/)?[Ii][Ff][Rr][Aa][Mm][Ee](\/)?>/g,""),b=b.replace(/<(\/)?[Oo][Bb][Jj][Ee][Cc][Tt](\/)?>/g,""),b=b.replace(/<(\/)?[Ee][Mm][Bb][Ee][De](\/)?>/g,"")},o=function(a){$("#bf_seq").val(a),$("#detailAndWriteform")[0].action="/board/BoardDownload.do",$("#detailAndWriteform").submit()},p=function(){var a={dateFormat:"yymmdd",changeMonth:!0,changeYear:!0,showAnim:"fadeIn"};$("#popup_expire_dt_span").hide(),$("#popup_check").change(function(){"N"==$(this).val()?$("#popup_expire_dt_span").hide():$("#popup_expire_dt_span").show()}),$("#popup_expire_dt").datepicker(a),$("#timeSet").change(function(){var a=this.value,b=_SL.formatDate("yyyyMMdd");if(0==a)$("#popup_expire_dt").val("");else{var c=_SL.formatDate.addMin(b+"0000",a);$("#popup_expire_dt").val(c.substring(0,8))}}),$("#popup_expire_dt").change(function(){$("#timeSet").val(0)})},q=function(a){for(var b=a,c=new Array("document.cookie","onabort","onactivate","onafterprint","onafterupdate","onbeforeactivate","onbeforecopy","onbeforecut","onbeforedeactivate","onbeforeeditfocus","onbeforepaste","onbeforeprint","onbeforeunload","onbeforeupdate","onbegin","onblur","onbounce","oncellchange","onchange","onclick","oncontentready","oncontentsave","oncontextmenu","oncontrolselect","oncopy","oncut","ondataavailable","ondatasetchanged","ondatasetcomplete","ondblclick","ondeactivate","ondetach","ondocumentready","ondrag","ondragdrop","ondragend","ondragenter","ondragleave","ondragover","ondragstart","ondrop","onend","onerror","onerrorupdate","onfilterchange","onfinish","onfocus","onfocusin","onfocusout","onhelp","onhide","onkeydown","onkeypress","onkeyup","onlayoutcomplete","onload","onlosecapture","onmediacomplete","onmediaerror","onmedialoadfailed","onmousedown","onmouseenter","onmouseleave","onmousemove","onmouseout","onmouseover","onmouseup","onmousewheel","onmove","onmoveend","onmovestart","onopenstatechange","onoutofsync","onpaste","onpause","onplaystatechange","onpropertychange","onreadystatechange","onrepeat","onreset","onresize","onresizeend","onresizestart","onresume","onreverse","onrowclick","onrowenter","onrowexit","onrowout","onrowover","onrowsdelete","onrowsinserted","onsave","onscroll","onseek","onselect","onselectionchange","onselectstart","onshow","onstart","onstop","onsubmit","onsyncrestored","ontimeerror","ontrackchange","onunload","onurlflip"),d=0;d<c.length;d++){var e="";e=c[d].indexOf("<")!=-1?b.replace(c[d],""):b.replace(c[d],""),b=e}return b};return{init:c}}(),$(function(){slapp.board.DetailAndWrite.init()});