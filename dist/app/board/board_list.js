"use strict";_SL.nmspc("board").list=function(){var a,b={formId:"#searchForm",gridId:"#gridBoardList",urlGetBoardList:"board_list.json",tableListId:".grid-table-group",pageRow:"#pageRow",currPage:"#currPage",divPaging:"#divPaging",divTotal:"#divTotal",pageRowUnit:[10,15,20,30,50,100]},c={form:$(b.formId),grid:$(b.gridId),sDay:$(b.formId+" [name=startDay]"),sHour:$(b.formId+" [name=startHour]"),sMin:$(b.formId+" [name=startMin]"),eDay:$(b.formId+" [name=endDay]"),eHour:$(b.formId+" [name=endHour]"),eMin:$(b.formId+" [name=endMin]"),tableList:$(b.tableListId+" tbody"),pageRow:$(b.pageRow),currPage:$(b.currPage),divPaging:$(b.divPaging),divTotal:$(b.divTotal)},d={rows:0,currPage:1},e=function(){for(var a in b.pageRowUnit)c.pageRow.append("<option value='"+b.pageRowUnit[a]+"'>"+b.pageRowUnit[a]+" Per Page</option>");c.pageRow.val("10"),slui.attach.setTransformSelect(b.formId),f(),g()},f=function(d){var e=$.extend({},_SL.serializeMap(c.form));$("body").requestData(b.urlGetBoardList,e,{callback:function(b){var d=c.tableList.empty();if(b.list.length<=0&&b.importantList.length<=0){var e=$("<tr>").append("<td colspan='4' class='list-empty'>There is no Search Result</td>").appendTo(d);return!1}var f=0;if($(".sp-total strong").text(""+b.totalCount),$(".sp-paging span").text(""+b.totalPage),a=b.totalPage,void 0!=b.importantList&&b.importantList.length>0)for(var g in b.importantList){var e=$("<tr>"),h=b.importantList[g];e.append("<td class='align-center'><span class='badge-basic'>공지</span></td>");var i="<a href='#' class='link-detail' data-godetail='Detail,"+h.bbs_seq+","+h.user_id+"' >";void 0!=h.bd_subject&&(i+=h.bd_subject),void 0!=h.comm_cnt&&"0"!=h.comm_cnt&&(i+="&nbsp;["+h.comm_cnt+"]"),i+="</a>",void 0!=h.popup_check&&"Y"==h.popup_check&&(i+="&nbsp;<span class='badge-attention'>Popup!</span>"),e.append($("<td>"+i+"</td>")),e.append($("<td class='align-center'>"+_SL.formatDate(h.reg_dt,"yyyyMMddHHmm","yyyy-MM-dd HH:mm")+"</td>")),e.append($("<td class='align-center'>"+h.user_nm+"</td>")),e.appendTo(d)}if(void 0!=b.list&&b.list.length>0)for(var g in b.list){f+=1;var e=$("<tr>"),h=b.list[g];"0"==h.depth?e.append($("<td class='align-center'>"+(1*b.totalCount-f-1*b.recordstartindex+1)+"</td>")):e.append($("<td class='align-center'><span class='badge-basic'>답변</span></td>"));var i="";void 0!=h.depth&&"0"!=h.depth&&(i+="└&nbsp;"),i+="<a href='#' class='link-detail' data-godetail='Detail,"+h.bbs_seq+","+h.user_id+"' >",void 0!=h.bd_subject&&(i+=h.bd_subject),void 0!=h.comm_cnt&&"0"!=h.comm_cnt&&(i+="&nbsp;["+h.comm_cnt+"]"),i+="</a>",void 0!=h.popup_check&&"Y"==h.popup_check&&(i+="&nbsp;<span class='badge-attention'>Popup!</span>"),e.append($("<td >"+i+"</td>")),e.append($("<td class='align-center'>"+_SL.formatDate(h.reg_dt,"yyyyMMddHHmm","yyyy-MM-dd HH:mm")+"</td>")),e.append($("<td class='align-center'>"+h.user_nm+"</td>")),e.appendTo(d)}}})},g=function(){c.currPage.keydown(function(a){if(13==a.keyCode){if(/[^\d]/.test(c.currPage.val())||c.currPage.val()>d.totalPage)return void _alert("Invalid Page Number!");setTimeout(function(){j(c.currPage.val(),d.rows)},1)}}),$(".btn-next",c.divPaging).on("click",function(){var c=d.currPage+1;c>a&&(c=a),$(b.currPage).val(c),d.currPage=c,f()}),$(".btn-prev",c.divPaging).on("click",function(){var a=d.currPage-1;a<1&&(a=1),$(b.currPage).val(a),d.currPage=a,f()}),$(b.pageRow).change(function(){$(b.currPage).val(1),d.currPage=1,f()}),$(".grid-table-group").off().on("click",".link-detail",function(){var a=$(this).attr("data-godetail"),b=a.split(",");i(b[0],b[1],b[2])}),$(".grid-bottom").off().on("click",".link-write",function(){i("write","")}),$(".btn-search").on("click",function(){h()})},h=function(){$("#ChkSelectSearch").val("Y"),$("#search_check").val("Y"),$("#searchForm")[0].action="/board/board_view.html",$("#searchForm").submit()},i=function(a,b,c){"Detail"==a&&""!=b?($("#writeChk").val("N"),$("#bbs_seq").val(b),$("#user_id").val(c),$("#searchForm")[0].action="/board/goDetailAndWrite.html",$("#searchForm").submit()):($("#StartChk").val("Y"),$("#writeChk").val("Y"),$("#searchForm")[0].action="/board/goDetailAndWrite.html",$("#searchForm").submit())},j=function(a,b){a="string"==typeof a?parseInt(a,10):a,b="string"==typeof b?parseInt(b,10):b,a<1&&(a=1),d.currPage=a,d.rows=b;for(var c=(a-1)*d.rows,e=0,f=0,g=0;g<d.rowsPerTime.length;g++){if(f+=d.rowsPerTime[g].rows,c+1<=f){d.sch_end_time=d.rowsPerTime[g].sch_end_time,d.sch_start_time=d.rowsPerTime[g].sch_start_time;break}e+=d.rowsPerTime[g].rows}d.sch_start_index=c-e,d.sch_rows=d.rows,d.listData=[],d.span_time=0,d.procIdx++,d.bCancel=!1,_removeDataRows(),_searchRequest()};return{init:e,movePage:j}}(),$(function(){slapp.board.list.init()});