"use strict";_SL.nmspc("comcode").form=function(){var a={formId:"#formComcode",urlSelect:gCONTEXT_PATH+"sysdata/comcode_form.json",urlExist:gCONTEXT_PATH+"sysdata/comcode_exist.json",urlDelete:gCONTEXT_PATH+"sysdata/comcode_delete.do",add:{action:gCONTEXT_PATH+"sysdata/comcode_insert.do",message:"등록 하시겠습니까?"},update:{action:gCONTEXT_PATH+"sysdata/comcode_update.do",message:"수정 하시겠습니까?"}},b={form:$(a.formId),codeId:$(a.formId+" [name=code_id]"),codeType:$(a.formId+" [name=s_code_type]"),codeName:$(a.formId+" [name=code_name]")},c={isNew:""==b.codeId.val(),mode:""==b.codeId.val()?a.add:a.update,code:{}},d=function(){f(),c.isNew?b.form.find(".btn-delete").hide():b.codeId.addClass("form-text").prop("readonly",!0),b.codeType.addClass("form-text").prop("readonly",!0),c.isNew||g()},e=function(){return c.code},f=function(){b.form.find(".btn-save").on("click",h),b.form.find(".btn-delete").on("click",i)},g=function(){var c=b.codeId.val(),d=b.codeType.val(),e={code_id:c,s_code_type:d},f=function(a){_SL.setDataToForm(a,b.form,{})};$("body").requestData(a.urlSelect,e,{callback:f})},h=function(){if(_SL.validate(b.form)){var d=b.codeId.val(),e=b.codeType.val(),f=b.codeName.val(),g=(1==$(this).data("after-close"),function(){$("body").requestData(c.mode.action,_SL.serializeMap(b.form),{callback:function(a,b,e){c.code.code_id=d,c.code.code_name=f,_alert(e,{onAgree:function(){j(!0)}})}})});c.isNew?$("body").requestData(a.urlExist,{code_id:d,s_code_type:e},{callback:function(a){"OK"==a?g():"EXIST"==a?_alert("사용중인 코드가 있어 처리 할 수 없습니다."):_alert("저장 처리중 에러가 발생했습니다.<br>다시 실행하세요.")}}):g()}},i=function(){var c=b.codeId.val(),d=b.codeType.val(),e=(1==$(this).data("after-close"),function(){_confirm("삭제하시겠습니까?",{onAgree:function(){$("body").requestData(a.urlDelete,{code_id:c,s_code_type:d},{callback:function(a,b,c){_alert(c,{onAgree:function(){j(!0)}})}})}})});return"Y"==b.form.find("[name=required]").val()?void _alert("필수 코드이므로 삭제할 수 없습니다."):void e()},j=function(a){a&&b.form.find("[data-layer-close=true]").click()};return{init:d,getCode:e}}(),$(function(){slapp.comcode.form.init()});