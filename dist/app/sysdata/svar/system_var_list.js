"use strict";_SL.nmspc("svar").list=function(){var a={urlList:gCONTEXT_PATH+"sysdata/system_var_list.json",urlForm:gCONTEXT_PATH+"sysdata/system_var_form.html",urlDownload:gCONTEXT_PATH+"sysdata/system_var_export.do",formId:"#searchSystemVarList",gridId:"#gridSystemVarList"},b={form:$(a.formId),grid:$(a.gridId)},c=function(){var c=b.grid.parent().siblings(".grid-bottom").find(".btn-add"),f=b.form.find(".btn-download");d(b.grid),b.form.find(".form-submit").off().on("click",function(){_SL.validate(b.form)&&e()}),c.off().on("click",function(){g(a.urlForm)}),f.off().on("click",function(){h()})},d=function(b){var c={datatype:"json",datafields:[{name:"var_nm",type:"string"},{name:"var_val",type:"string"},{name:"var_type",type:"string"},{name:"var_comments",type:"string"},{name:"open_time",type:"string"},{name:"proc_id",type:"string"},{name:"proc_ip",type:"string"},{name:"proc_dt",type:"string"},{name:"ref_cnt",type:"string"}],root:"rows",beforeprocessing:function(a){null!=a&&(c.totalrecords=a.totalRows)},cache:!1,url:a.urlList},d=new $.jqx.dataAdapter(c,{beforeLoadComplete:function(a){for(var b in a)a[b].proc_dt=_SL.formatDate(a[b].proc_dt,"yyyyMMddHHmmss","yyyy-MM-dd HH:mm:ss");return a},formatData:function(b){var c,d={},e=$(a.formId).serializeArray();for(c in e)d[e[c].name]=e[c].value;return $.extend(b,d),b},loadComplete:function(){f()},loadError:function(a,b,c){alert(c)}});b.jqxGrid({source:d,sortable:!0,virtualmode:!0,rendergridrows:function(a){return a.data},columns:[{text:"No",columntype:"number",width:"30",cellsalign:"center",cellsrenderer:function(a,b,c,d){return $(d).text(c+1)[0].outerHTML}},{text:"시스템변수명",datafield:"var_nm",width:"20%",cellsrenderer:function(a,b,c,d,e,f){var g=c.substring(0,14)+(c.length>14?"...":"");return $(d).html('<button type="button" class="btn-link hasTooltip" data-value="'+c+'">'+g+"</button>")[0].outerHTML}},{text:"시스템변수내용",datafield:"var_val",cellsrenderer:function(a,b,c,d,e,f){var g=c.substring(0,28)+(c.length>28?"...":"");return $(d).html('<label class="hasTooltip" data-value="'+c+'">'+g+"</label>")[0].outerHTML}},{text:"참조건수",datafield:"ref_cnt",width:"10%",cellsalign:"center"},{text:"작성자",datafield:"proc_id",width:"15%",cellsalign:"center"},{text:"등록일",datafield:"proc_dt",width:"15%",cellsalign:"center"}]}),b.on("cellclick",function(b){if("var_nm"===b.args.datafield){var c=b.args.row.bounddata.var_nm;g(a.urlForm+"?var_nm="+c)}})},e=function(){b.grid.jqxGrid("updatebounddata"),f()},f=function(){setTimeout(function(){b.grid.find(".hasTooltip").each(function(a){var b=$(this).data("value");$(this).jqxTooltip({position:"mouse",content:b})})},500)},g=function(a){new ModalPopup(a,{width:800,height:460,onClose:function(){e()}})},h=function(){_SL.validate(b.form)&&b.form.attr({action:a.urlDownload}).submit()};return{init:c}}(),$(function(){slapp.svar.list.init()});