"use strict";_SL.nmspc("pms").form=function(){var a={gridId:"#gridPmsStatList",formId:"#searchPmsStatList",urlList:gCONTEXT_PATH+"management/pms_stat_list.json?s_app_seq="+appSeq,urlForm:gCONTEXT_PATH+"management/pms_stat_form.html?s_app_seq="+appSeq+"&s_evt_type="+evtType,urlRetry:gCONTEXT_PATH+"management/pms_retry.do"},b={grid:$(a.gridId),form:$(a.formId)},c=function(){var c=b.grid.parent().siblings(".grid-bottom").find(".btn-add"),d=b.grid.parent().siblings(".grid-bottom").find(".btn-retry");b.form.find(".form-submit").on("click",function(){f()}),c.on("click",function(){new ModalPopup(a.urlForm,{width:900,height:480,draggable:!0,onClose:function(){f()}})}),d.on("click",function(){g()}),$("#windowTest").jqxWindow({height:220,width:360,autoOpen:!1,resizable:!1,isModal:!0,modalOpacity:.5})},d=function(){e(b.grid),c()},e=function(c){var d={datatype:"json",datafields:[{name:"key",type:"string"},{name:"server_seq",type:"string"},{name:"status",type:"string"},{name:"del_yn",type:"string"},{name:"server_nm",type:"string"},{name:"server_ip",type:"string"},{name:"status_name",type:"string"},{name:"message",type:"string"},{name:"log",type:"string"},{name:"upd_date_format",type:"string"}],root:"rows",beforeprocessing:function(a){null!=a&&(d.totalrecords=a.totalRows)},cache:!1,url:a.urlList},e=new $.jqx.dataAdapter(d,{beforeLoadComplete:function(a){for(var b in a)a[b].upd_date_format=_SL.formatDate(a[b].upd_date_format,"yyyyMMddHHmm","yyyy-MM-dd HH:mm"),a[b].expire_dt&&(a[b].expire_dt=_SL.formatDate(a[b].expire_dt,"yyyyMMdd","yyyy-MM-dd"));return a},formatData:function(a){var c,d={},e=b.form.serializeArray();for(c in e)d[e[c].name]=e[c].value;return $.extend(a,d),a},loadError:function(a,b,c){alert(c)}});c.jqxGrid({source:e,sortable:!0,width:"100%",virtualmode:!0,selectionmode:"checkbox",enablehover:!1,rendergridrows:function(a){return a.data},columns:[{text:"No",columntype:"number",width:40,cellsalign:"center",cellsrenderer:function(a,b,c,d){return $(d).text(c+1)[0].outerHTML}},{text:"서버명",datafield:"server_nm",width:"20%"},{text:"IP",datafield:"server_ip",cellsalign:"center",width:"12%"},{text:"상태",datafield:"status_name",cellsalign:"center",width:"10%"},{text:"메시지",datafield:"message"},{text:"패치일",datafield:"upd_date_format",cellsalign:"center",width:"12%"}]})},f=function(){b.grid.jqxGrid("updatebounddata"),b.grid.jqxGrid("clearselection")},g=function(){var c=($(this).data("handle-type"),$(this).text(),b.grid.jqxGrid("selectedrowindexes")),d=b.grid.jqxGrid("getdisplayrows"),e=[];for(var g in d)for(var h=0,i=c.length;h<i;h++)c[h]==d[g].boundindex&&e.push(d[g].boundindex);return e.length<1?void _alert("재시도 할 서버를 선택해주세요."):void _confirm("재시도 하시겠습니까?",{onAgree:function(){var c=(e.length,{}),d=[];for(var g in e){var h=b.grid.jqxGrid("getrowdata",e[g]);if(!h){f();break}var i=h.server_seq;d.push(i)}c={s_app_seq:appSeq,server_seqs:d.join(",")},$("body").requestData(a.urlRetry,c,{callback:function(a,b,c){_alert(c,{onAgree:function(){f()}})}})}})};return{init:d}}(),$(function(){slapp.pms.form.init()});