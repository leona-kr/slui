"use strict";_SL.nmspc("bigStatsManager").form=function(){var a,b,c,d,e=null,f=null,g=null,h={formId:"#formBigStatsManager",urlSelect:gCONTEXT_PATH+"analysis/big_stats_manager.json",urlLoadBigStatsList:gCONTEXT_PATH+"analysis/load_big_stats_list_form.html",urlLoadBigStats:gCONTEXT_PATH+"analysis/big_stats_manager.json",urlLoadFileList:gCONTEXT_PATH+"analysis/load_big_file_list_form.html",urlLoadBigFileData:gCONTEXT_PATH+"analysis/load_big_file_data.json",urlLoadBigDbData:gCONTEXT_PATH+"analysis/load_big_db_data.do",urlChkLastCode:gCONTEXT_PATH+"analysis/check_last_bigcode.do",urlStopBigStats:gCONTEXT_PATH+"analysis/big_stats_stop.do",urlLoadBigDbData:gCONTEXT_PATH+"analysis/load_big_db_data.do",urlAutoJoinField:gCONTEXT_PATH+"analysis/get_auto_join_field.do",add:{action:gCONTEXT_PATH+"analysis/big_stats_insert.do",message:"등록 하시겠습니까?"},update:{action:gCONTEXT_PATH+"analysis/big_stats_retry.do",message:"재실행 하시겠습니까?"}},i={form:$(h.formId),bigCode:$(h.formId+" [name=big_code]"),scheduleId:$(h.formId+" [name=schedule_id]"),pageType:$(h.formId+" [name=page_type]"),status:$(h.formId+" [name=status]"),procPct:$(h.formId+" [name=proc_pct]"),lastCodeYn:$(h.formId+" [name=last_code_yn]"),schStartTime:$(h.formId+" [name=schStartTime]"),schEndTime:$(h.formId+" [name=schEndTime]"),datasetTreeTd:$(h.formId+" .dataset_tree_td"),itemListTable:$(h.formId+" .item_list_table"),statsNm:$(h.formId+" [name=stats_nm]"),genCycleType:$(h.formId+" [name=mixed_gen_cycle_type]"),genSch:$(h.formId+" [name=gen_sch]"),genStartWeek:$(h.formId+" [name=genStartWeek]"),genStartDay2:$(h.formId+" [name=genStartDay2]"),genStartDay:$(h.formId+" [name=genStartDay]"),genStartHour:$(h.formId+" [name=genStartHour]"),genStartMin:$(h.formId+" [name=genStartMin]"),shareUser:$(h.formId+" [name=share_user]"),shareUserList:$(h.formId+" [name=share_user_list]"),setType:$(h.formId+" [name=set_type]"),clientGroupCd:$(h.formId+" [name=client_group_cd]"),timeSet:$(h.formId+" [name=timeSet]"),schStartDay:$(h.formId+" [name=schStartDay]"),schStartHour:$(h.formId+" [name=schStartHour]"),schStartMin:$(h.formId+" [name=schStartMin]"),schEndDay:$(h.formId+" [name=schEndDay]"),schEndHour:$(h.formId+" [name=schEndHour]"),schEndMin:$(h.formId+" [name=schEndMin]"),schQuery:$(h.formId+" [name=sch_query]"),fileId:$(h.formId+" [name=file_id]"),fileDataName:$(h.formId+" [name=file_data_name]"),orgFileName:$(h.formId+" [name=org_file_name]"),sqlQuery:$(h.formId+" [name=sql_query]"),genSpan:$(h.formId+" .gen_span"),genCalDaySpan:$(h.formId+" .gen_cal_day_span"),genDaySpan:$(h.formId+" .gen_day_span"),genWeekSpan:$(h.formId+" .gen_week_span"),genHourSpan:$(h.formId+" .gen_hour_span"),genMinSpan:$(h.formId+" .gen_min_span"),timeSetTr:$(h.formId+" .time_set_tr"),joinTr:$(h.formId+" .join_tr"),setTypeTr:$(h.formId+" .set_type_tr"),setTypeS:$(h.formId+" .set_type_s"),setTypeF:$(h.formId+" .set_type_f"),setTypeD:$(h.formId+" .set_type_d"),joinTd:$(h.formId+" .join_td"),btnImport:$(h.formId+" .btn-import"),btnAddUser:$(h.formId+" .add_user"),btnDelUser:$(h.formId+" .del_user"),btnAddTree:$(h.formId+" .btn-add-tree"),btnDelTree:$(h.formId+" .btn-del-tree"),btnFileLoad:$(h.formId+" .btn-file-load"),btnFldChk:$(h.formId+" .btn-fld-chk"),btnFldJoin:$(h.formId+" .btn-fld-join"),btnAddItem:$(h.formId+" .btn-add-item"),dummy:{}},j={isNew:""==i.bigCode.val(),isLoad:"big_stats_mng_load"==i.pageType.val(),mode:""==i.bigCode.val()||"big_stats_mng_load"==i.pageType.val()?h.add:h.update},k=function(){p.init(),0==f.getActiveNode().data.dto.set_seq?(i.form.find(".set_type_tr").hide(),i.form.find(".set_type_s").hide(),i.form.find(".set_type_f").hide(),i.form.find(".set_type_d").hide()):i.form.find(".set_type_tr").show(),j.isNew?(i.form.find("[data-type=stop]").hide(),i.form.find("[data-type=retry]").hide(),l()):M(),m()},l=function(){n(),q(),t(),u(),v()},m=function(){i.form.find(".btn-save").on("click",I),p.btnInit(),i.genCycleType.on("change",n),i.genSch.on("change",o),i.genSch.on("change",function(){var a=i.genSch.val(),b=_SL.formatDate.addMin(_SL.formatDate(),+a);0==a&&(b=_SL.formatDate()),i.genStartDay.val(b.substring(0,8)),i.genStartHour.val(b.substring(8,10)),i.genStartMin.val(b.substring(10,12))}),i.form.find("[name=genStartDay], [name=genStartHour], [name=genStartMin]").change(function(){i.genSch.val(0)}),i.timeSet.change(function(){var a=this.value;if(0!=a){var b=function(a,b){var c=a.siblings(".tform-select");c.find(".tform-select-t").text(b).end().find(".tform-select-option[data-value="+b+"]").addClass("selected").end(),a.val(b)},c=_SL.formatDate.addMin(i.form.find("[name=schEndDay]").val()+i.form.find("[name=schEndHour]").val()+i.form.find("[name=schEndMin]").val(),-a);b(i.form.find("[name=schStartDay]"),c.substring(0,8)),b(i.form.find("[name=schStartHour]"),c.substring(8,10)),b(i.form.find("[name=schStartMin]"),c.substring(10,12))}}),i.form.find("[name=schStartDay], [name=schStartHour], [name=schStartMin], [name=schEndDay], [name=schEndHour], [name=schEndMin]").change(function(){var a=i.form.find("[name=timeSet]"),b=a.siblings(".tform-select").find("[data-value=0]").text();a.val(0).siblings(".tform-select").find(".tform-select-t").text(b)}),x(),i.setType.change(y),i.schQuery.keyup(function(){var a=f.getActiveNode();if(null!=a&&0!=a.data.dto.set_seq){var b=p.getFormData();a.setTitle(b.title)}}),i.sqlQuery.keyup(function(){var a=f.getActiveNode();if(null!=a&&0!=a.data.dto.set_seq){var b=p.getFormData();a.data.dto.checkDb=!1,$.extend(a.data.dto,b),a.setTitle(b.title)}}),i.form.on("click","[name=join_operator]",function(){var a=$(this);a.data("prev",a.val())}),i.form.on("change","[name=join_operator]",z),i.form.on("change","[name=field_set_seq]",A),i.form.on("change","[name=func_field_set_seq]",B),i.form.on("change","[name=view_type]",C),i.form.on("change","[name=func]",u),i.form.on("change","[name=field_nm]",t),$("[name=field_nm]").chosen(),$("[name=func_field_nm]").chosen(),i.btnFldChk.on("click",D),i.btnFileLoad.exModalPopup(h.urlLoadFileList,{width:500,height:131,onClose:function(){}}),i.btnFldJoin.on("click",F),i.btnImport.exModalPopup(h.urlLoadBigStatsList,{width:500,height:135,onClose:function(){O(!0)}}),i.btnAddUser.click(function(){var a=i.form.find("[name=share_user] option:selected").val(),b=i.form.find("[name=share_user] option:selected").text();return""==a?void _alert("사용자를 선택하세요."):i.form.find("[name=share_user_list] option").is(function(){return this.value==a})?void _alert("해당 ID가 이미 존재합니다. ( ID : "+a+" )"):void i.form.find("[name=share_user_list]").append("<option value='"+a+"'>"+b+"</option>")}),i.btnDelUser.click(function(){i.form.find("[name=share_user_list] :selected").remove()})},n=function(){var a=i.genCycleType.val();i.form.find(".gen_span, .gen_cal_day_span, .gen_day_span, .gen_week_span, .gen_hour_span, .gen_min_span").hide(),o(),0==a.indexOf("1")?i.form.find(".gen_span").show():0==a.indexOf("d")?i.form.find(".gen_hour_span, .gen_min_span").show():0==a.indexOf("w")?i.form.find(".gen_week_span, .gen_hour_span, .gen_min_span").show():0==a.indexOf("M")&&i.form.find(".gen_day_span, .gen_hour_span, .gen_min_span").show(),0==a.indexOf("1")&&"S"==i.setType.val()?i.timeSetTr.show():i.timeSetTr.hide()},o=function(){"1,0"!=i.genCycleType.val()&&i.genSch.val(""),""==i.genSch.val()?i.form.find(".gen_cal_day_span, .gen_day_span, .gen_week_span, .gen_hour_span, .gen_min_span").hide():i.form.find(".gen_cal_day_span, .gen_hour_span, .gen_min_span").show()},p={init:function(){var a=p.getInitData();a.set_seq=0,e={title:"DATA",key:"0",dto:a,isFolder:!0,children:[]},i.datasetTreeTd.dynatree({minExpandLevel:99,autoFocus:!0,clickFolderMode:3,onActivate:function(a){if(null!=g&&0!=g.data.dto.set_seq&&g!=a){var b=p.getFormData();if($.extend(g.data.dto,b),g.setTitle(b.title),!p.nodeValidate())return g.activate(),void g.focus()}g=a;var c=a.data.dto.sch_start_time,d=a.data.dto.sch_end_time;i.setType.val(a.data.dto.set_type),gNetworkList.length>1&&a.data.dto.client_group_cd&&i.clientGroupCd.val(a.data.dto.client_group_cd.split(",")),i.schStartDay.val(c.substring(0,8)),i.schStartHour.val(c.substring(8,10)),i.schStartMin.val(c.substring(10,12)),i.schEndDay.val(d.substring(0,8)),i.schEndHour.val(d.substring(8,10)),i.schEndMin.val(d.substring(10,12)),i.schQuery.val(a.data.dto.sch_query),i.fileId.val(a.data.dto.file_id),i.fileDataName.val(a.data.dto.file_data_name),i.orgFileName.val(a.data.dto.org_file_name),i.sqlQuery.val(a.data.dto.sql_query);var e=a.data.dto.set_seq;if(null!=a&&0!=e){var b=p.getFormData();a.setTitle(b.title)}0==e||1==e?i.joinTr.hide():i.joinTr.show(),0!=e&&(i.form.find(".join_div").remove(),r(a,"*","*","IN"));var f=a.data.dto.join_field_list;for(var h in f)0==h&&i.form.find(".join_div").remove(),r(a,f[h].field_nm,f[h].rel_field,f[h].operator);q(),v(),0==e?(i.setTypeTr.hide(),i.setTypeS.hide(),i.setTypeF.hide(),i.setTypeD.hide()):i.setTypeTr.show(),n()},children:[e]}),f=i.datasetTreeTd.dynatree("getTree");var b=f.getNodeByKey("0");b.activate()},btnInit:function(){i.btnAddTree.click(function(){var a=f.getActiveNode();if(null!=a){if(0!=a.data.dto.set_seq){if(!p.nodeValidate())return;var b=p.getFormData();$.extend(g.data.dto,b),g.setTitle(b.title)}else if(a.hasChildren())return;var c,d=p.getInitData(),e=0;if(a.hasChildren()?(f.getActiveNode().visit(function(a){e<a.data.dto.set_seq&&(e=a.data.dto.set_seq)}),c=e+1):c=a.data.dto.set_seq+1,c>2)return void _alert("더 이상 등록 할 수 없습니다");f.visit(function(a){if(c<=a.data.dto.set_seq){a.data.dto.set_seq+=1,a.data.key=String(Number(a.data.key)+1);var b,d=a.data.dto.set_type;switch(d){case"S":b=a.data.key+".[검색] : "+a.data.dto.sch_query;break;case"F":b=a.data.key+".[파일] : "+a.data.dto.file_data_name;break;case"D":b=a.data.key+".[DB] : "+a.data.dto.sql_query}a.data.title=b,a.setTitle(b)}c<=a.data.dto.rel_set_seq&&(a.data.dto.rel_set_seq+=1)}),d.set_seq=c,d.rel_set_seq=g.data.dto.set_seq;var h=a.addChild({title:"New",key:c,dto:d,focus:!0,children:[]});if(g=h,g.activate(),2==f.count()||"="==i.form.find("[name=join_operator]").val()){var j=f.count()-1,k=i.itemListTable.find("[name=field_set_seq],[name=func_field_set_seq]");k.append($('<option value="'+j+'">DATA.'+j+"</option>"))}n()}else _alert("DATA를 선택해주세요.")}),i.btnDelTree.click(function(){var a=[],b=[],c=f.getActiveNode();if(null!=c){a.push(String(c.data.dto.set_seq)),c.visit(function(b){a.push(String(b.data.dto.set_seq))});var d=c.data.dto;if(0==d.set_seq)return;if(1==d.set_seq)confirm("전체를 삭제하시겠습니까?")&&f.getNodeByKey("0").removeChildren();else if(c.hasChildren()){if(!confirm("하위 데이터도 함께 삭제 합니다."))return;f.visit(function(a){if(d.set_seq<a.data.dto.set_seq){b.push(String(a.data.dto.set_seq));var e=c.countChildren()+1;a.data.dto.set_seq-=e,a.setTitle(p.getTitle(a.data.dto))}}),c.remove()}else{if(!confirm("삭제하시겠습니까?"))return;f.visit(function(a){d.set_seq<a.data.dto.set_seq&&(b.push(String(a.data.dto.set_seq)),a.data.dto.set_seq-=1,a.setTitle(p.getTitle(a.data.dto)))}),c.remove()}f.visit(function(a){if(0!=a.data.dto.set_seq){var b=a.getParent();a.data.dto.rel_set_seq=b.data.dto.set_seq}}),i.form.find("[name=field_set_seq]").each(function(){if(a.indexOf($(this).val())!=-1){$(this).attr("aria-value","");var b=$(this).closest("td").find("[name=field_nm]"),c=new Object({data:{dto:{set_type:"del",file_id:""}}});s(b,c,"*")}}),i.form.find("[name=func_field_set_seq]").each(function(){if(a.indexOf($(this).val())!=-1){$(this).attr("aria-value","");var b=$(this).closest("td").find("[name=func_field_nm]"),c=new Object({data:{dto:{set_type:"del",file_id:""}}});s(b,c,"*")}}),i.form.find("[name=field_set_seq]").each(function(){if(b.indexOf($(this).val())!=-1){var a="";null!=f.getNodeByKey($(this).val())&&(a=f.getNodeByKey($(this).val()).data.dto.set_seq),$(this).attr("aria-value",a)}}),i.form.find("[name=func_field_set_seq]").each(function(){if(b.indexOf($(this).val())!=-1){var a="";null!=f.getNodeByKey($(this).val())&&(a=f.getNodeByKey($(this).val()).data.dto.set_seq,$(this).attr("aria-value",a)),$(this).attr("aria-value",a)}}),i.form.find("[name=field_set_seq]").each(function(){$(this).find("option").remove();var a=$(this).attr("aria-value");$(this).append($("<option value=''>[선택]</option>"));for(var b=1;b<f.count();b++)$(this).append($("<option value='"+b+"'>DATA."+b+"</option>"));$(this).val(a)}),i.form.find("[name=func_field_set_seq]").each(function(){$(this).find("option").remove();var a=$(this).attr("aria-value");$(this).append($("<option value=''>[선택]</option>"));for(var b=1;b<f.count();b++)$(this).append($("<option value='"+b+"'>DATA."+b+"</option>"));$(this).val(a)});for(var e in b){var j=b[e],k=f.getNodeByKey(j);null!=k&&(f.getNodeByKey(b[e]).data.key=String(k.data.dto.set_seq))}g=null,slui.attach.setTransformSelect(h.formId)}else console.log("선택된 노드 없습니다.")})},getInitData:function(){var a=i.schStartTime.val(),b=i.schEndTime.val();return{sch_start_time:a,sch_end_time:b,set_type:"S",field_nm:"*",rel_field:"*",file_id:""}},getFormData:function(){var a=i.schStartDay.val()+i.schStartHour.val()+i.schStartMin.val(),b=i.schEndDay.val()+i.schEndHour.val()+i.schEndMin.val(),c=g.data.dto.set_seq,d=i.setType.val(),e=$.trim(i.sqlQuery.val());e=e.replace(/;+$/,"");var f={set_seq:c,set_type:d,client_group_cd:1==gNetworkList.length?gNetworkList[0].code_id:i.clientGroupCd.map(function(){return $(this).val()}).get().join(),sch_start_time:a,sch_end_time:b,sch_query:$.trim(i.schQuery.val()),file_id:i.fileId.val(),file_data_name:i.fileDataName.val(),org_file_name:i.orgFileName.val(),sql_query:e};f.title=p.getTitle(f);for(var h=i.form.find(".join_div").length,j=[],k=0;k<h;k++){var l=i.form.find("[name=join_field_nm]").eq(k).val(),m=i.form.find("[name=join_rel_field]").eq(k).val(),n=i.form.find("[name=join_operator]").eq(k).val();j.push({field_nm:l,rel_field:m,operator:n})}return f.join_field_list=j,f},getTitle:function(a){var b="";switch(a.set_type){case"S":b=a.set_seq+".[검색] : "+a.sch_query;break;case"F":b=a.set_seq+".[파일] : "+a.file_data_name;break;case"D":b=a.set_seq+".[DB] : "+a.sql_query}return b},nodeValidate:function(){var a=i.setType.val(),b=!0;switch(a){case"S":if(gNetworkList.length>1&&0==i.form.find("[name=client_group_cd]:checked").length)return void _alert("검색할 Network을 체크하세요.");var c=i.schStartDay.val()+i.schStartHour.val()+i.schStartMin.val(),d=i.schEndDay.val()+i.schEndHour.val()+i.schEndMin.val();_SL.formatDate.diff(c,d);if(c>d)return void _alert("검색기간 종료시간이 시작시간보다 커야 합니다.");_SL.validate(i.schQuery)||(b=!1);break;case"F":_SL.validate(i.fileDataName)||(b=!1);break;case"D":if(!_SL.validate(i.sqlQuery)){b=!1;break}g.data.dto.checkDb||(_alert("필드정보Check를 해주세요."),b=!1);break;default:return b=!1}if(b){var e=g.data.dto.set_seq;if(0==e||1==e)console.log("join_field_append_pass");else{if(i.form.find("[name=join_rel_field]").each(function(){"*"==$(this).val()&&b&&(_alert("데이터관계를 설정해주세요."),b=!1)}),i.form.find("[name=join_field_nm]").each(function(){"*"==$(this).val()&&b&&(_alert("데이터관계를 설정해주세요."),b=!1)}),!b)return;for(var f=i.form.find(".join_div").length,h=[],j=0;j<f;j++){var k=i.form.find("[name=join_rel_field]").eq(j).val()+i.form.find("[name=join_field_nm]").eq(j).val();if(h.indexOf(k)!=-1){_alert("데이터 관계정의에 중복된 내용이 있습니다."),b=!1;break}h.push(k)}}return b}}},q=function(){var a=i.setType.val();switch(a){case"S":i.setTypeS.show(),i.setTypeF.hide(),i.setTypeD.hide();break;case"F":i.setTypeS.hide(),i.setTypeF.show(),i.setTypeD.hide();break;case"D":i.setTypeS.hide(),i.setTypeF.hide(),i.setTypeD.show()}},r=function(a,b,c,d){var e=i.joinTd,f=a,g=(f.data.dto.set_seq,b),h=f.getParent(),j=(h.data.dto.set_seq,c),k=$('<select name="join_field_nm" data-ui="false"><option value="*">[선택하세요]</option></select>'),l=$('<span class="form-select-outer" />'),m=$('<select name="join_operator" class="form-select" data-ui="false" />').append('<option value="IN">IN</option>').append('<option value="NOT IN">NOT IN</option>').append('<option value="=">INNER JOIN</option>').append('<option value="=*">OUTER JOIN</option>').appendTo(l);i.form.find(".join_div").length>=1&&m.prop("disabled",!0);var n=$('<select name="join_rel_field" data-ui="false"><option value="*">[선택하세요]</option></select>'),o=$('<button type="button" class="btn-basic btn-mini btn-plus add_join"><i class="icon-plus"></i></button>'),p=$('<button type="button" class="btn-basic btn-mini btn-minus del_join"><i class="icon-minus"></i></button>'),q=$('<div class="range-4" />').append("DATA&nbsp;",n),r=$('<div class="range-1" />').append(l),t=$('<div class="range-1" />'),u=$('<div class="range-4" />').append("DATA&nbsp;",k,o,p),v=$('<div class="ranges-group join_div" />').append(q,r,t,u);e.append(v),m.val(d),s(k,f,g),s(n,h,j)},s=function(c,d,e){var f=d.data.dto.set_type,g=d.data.dto.file_id,i=d.data.dto.sql_query;switch(c.html('<option value="*">[선택하세요]</option>'),f){case"S":gFieldCaptions=gOrgFieldCaptions,$.each(gFieldCaptions,function(a,b){c.append('<option value="'+a+'">'+b+" ["+a+"]</option>")}),c.chosen(),c.val(e),c.trigger("chosen:updated");break;case"F":if(""==g){gFieldCaptions=gOrgFieldCaptions,$.each(gFieldCaptions,function(a,b){c.append('<option value="'+a+'">'+b+" ["+a+"]</option>")}),c.chosen(),c.val(e),c.trigger("chosen:updated");break}$("body").requestData(h.urlLoadBigFileData,{file_id:g},{callback:function(b,d,f){"SUC_COM_0000"==d?(a=b.fileFieldMap,$.each(a,function(a,b){c.append('<option value="'+a+'">'+b+" ["+a+"]</option>")}),c.chosen(),c.val(e),c.trigger("chosen:updated"),t()):_alert("파일의 필드정보를 불러오는 중 에러가 발생했습니다.")}});break;case"D":if(""==i||!d.data.dto.checkDb){gFieldCaptions=gOrgFieldCaptions,$.each(gFieldCaptions,function(a,b){c.append($('<option value="'+a+'">'+b+" ["+a+"]</option>"))}),c.chosen(),c.val(e),c.trigger("chosen:updated");break}d.data.dto.checkDb&&$("body").requestData(h.urlLoadBigDbData,{sql_query:i},{callback:function(a,d,f){"SUC_COM_0000"==d?(b=a.fileFieldMap,$.each(b,function(a,b){c.append($('<option value="'+a+'">'+b+" ["+a+"]</option>"))}),c.chosen(),c.val(e),c.trigger("chosen:updated"),t()):_alert("Query의 필드정보를 불러오는 중 에러가 발생했습니다.<br>Query를 확인해주세요.")}});break;case"del":c.val(e),c.trigger("chosen:updated")}t()},t=function(){for(var a=i.itemListTable,b=a.find("[name=field_nm]").length,c=0;c<b;c++){var d=i.form.find("[name=field_nm]").eq(c).val(),e=i.form.find("[name=field_nm]").eq(c).parents(".field_tree_div");"eqp_dt"!=d?e.find("[name=field_func]").parents("[class*=range-]").hide():e.find("[name=field_func]").parents("[class*=range-]").show()}},u=function(){for(var a=i.itemListTable,b=a.find("[name=func]").length,c=0;c<b;c++){var d=i.form.find("[name=func]").eq(c).val(),e=i.form.find("[name=func]").eq(c).parents("td");"count"==d?(e.find("[name=func_field_nm]").val("*"),e.find("[name=func_field_nm]").prop("disabled",!0),e.find("[name=func_field_nm]").trigger("chosen:updated")):(e.find("[name=func_field_set_seq]").prop("disabled",!1),e.find("[name=func_field_nm]").prop("disabled",!1),e.find("[name=func_field_nm]").trigger("chosen:updated"))}slui.attach.setTransformSelect(h.formId)},v=function(){var a=i.pageType.val();if(!j.isNew){var b=i.status.val(),c=i.lastCodeYn.val();if(!b)return;i.form.find("[data-type=save]").hide(),("N"==c&&""==a||"0"!=b&&"9"!=b&&""==a)&&(i.btnImport.hide(),i.form.find("[data-type=retry]").hide(),"12348".indexOf(b)>-1&&"Y"==c&&i.form.find("[data-type=stop]").show(),i.form.find("input,textarea").prop("readonly",!0),i.form.find("input,textarea,table button,select").prop("disabled",!0),i.form.find("[name=join_field_nm]").prop("disabled",!0),i.form.find("[name=join_rel_field]").trigger("chosen:updated"),i.form.find("[name=join_field_nm]").trigger("chosen:updated"))}"big_stats_mng_load"==a?(i.form.find("[data-type=retry]").hide(),i.form.find("[data-type=save]").show(),i.bigCode.val(""),i.scheduleId.val(""),i.status.val(""),i.lastCodeYn.val("")):"0"==b&&i.form.find("[data-type=retry]").show(),w(),i.shareUser.chosen({width:"100%"}),setTimeout(function(){slui.attach.setTransformSelect(h.formId)},10)},w=function(){var a=i.form.find("[name=join_operator]:first").val();"="==a||"=*"==a?i.btnFldJoin.css("visibility","visible"):i.btnFldJoin.css("visibility","hidden")},x=function(){i.form.on("click",".add_join",function(a){var b=i.form.find("[name=join_operator]").first().val();return"NOT IN"==b||"IN"==b?void _alert("더이상 등록 할 수 없습니다."):void r(f.getActiveNode(),"*","*",b)}),i.form.on("click",".del_join",function(a){var b=$(this).parents("div");b.is(".join_div:first")||b.remove()}),i.btnAddItem.on("click",function(a){for(var b=i.itemListTable,c=$("<tr class='item_tr' />"),d=($('<input name="item_nm" class="form-input" type="text" data-valid="분석항목명,required" style="width:100%;">').appendTo($("<td />").appendTo(c)),$('<span class="form-select-outer" />').appendTo($("<td />").appendTo(c))),e=($('<select name="view_type" class="form-select" />').append('<option value="P">Pie</option>').append('<option value="B">Bar</option>').append('<option value="L">Line</option>').append('<option value="T">TimeLine</option>').appendTo(d),$('<span class="range-2 form-select-outer" />')),g=$('<select name="field_set_seq" class="form-select" />').append('<option value="">[선택]</option>').appendTo(e),h=1;h<f.count();h++){var j=f.getNodeByKey(String(h));if(h>1){var k;if(k=j.data.dto.join_field_list?j.data.dto.join_field_list[0].operator:i.form.find("[name=join_operator]").first().val(),"="!=k&&"=*"!=k)continue}g.append('<option value="'+h+'">DATA.'+h+"</option>")}var l=$('<span class="range-4" />'),m=($('<select name="field_nm" class="form-select" data-ui="false" />').append('<option value="*">[선택하세요]</option>').appendTo(l),$('<span class="range-2 form-select-outer" />')),n=($('<select name="field_func" class="form-select" />').append('<option value="8">일</option>').append('<option value="10">시</option>').append('<option value="11">10분</option>').append('<option value="12">1분</option>').appendTo(m),$('<span class="range-2" />'));$('<button type="button" class="btn-basic btn-mini btn-plus btn-add-field"><i class="icon-plus"></i></button>').appendTo(n),$('<button type="button" class="btn-basic btn-mini btn-minus btn-del-field"><i class="icon-minus"></i></button>').appendTo(n);c.append($('<td class="field_nm_td">').append($('<div class="field_tree_div ranges-group">').append(e,l,m,n)));for(var o=$('<span class="range-2 form-select-outer" />'),p=($('<select name="func" class="form-select" />').append('<option value="count">Count</option>').append('<option value="sum">SUM</option>').append('<option value="avg">AVG</option>').append('<option value="max">MAX</option>').append('<option value="min">MIN</option>').appendTo(o),$('<span class="range-3 func_field_span form-select-outer" />')),q=$('<select name="func_field_set_seq" class="form-select" />').append('<option value="">[선택]</option>').appendTo(p),h=1;h<f.count();h++){var j=f.getNodeByKey(String(h));if(h>1){var k;if(k=j.data.dto.join_field_list?j.data.dto.join_field_list[0].operator:i.form.find("[name=join_operator]").first().val(),"="!=k&&"=*"!=k)continue}q.append("<option value='"+h+"'>DATA."+h+"</option>")}var r=$('<span class="range-5 form-select-outer" />'),s=($('<select name="func_field_nm" class="form-select" data-ui="false" />').append('<option value="*">[선택하세요]</option>').appendTo(r),$('<div class="ranges-group" />').append(o,p,r));c.append($("<td>").append(s));$('<button type="button" class="btn-basic btn-mini btn-minus btn-del-item"><i class="icon-minus"></i></button>').appendTo($('<td class="imgTd">').appendTo(c.appendTo(b)));c.find("[name=field_nm]").chosen(),c.find("[name=func_field_nm]").chosen(),t(),u()}),i.form.on("click",".btn-del-item",function(a){var b=i.itemListTable;if(1!=b.find("tr").length){var c=$(this).parents("tr");c.remove()}}),i.form.on("click",".btn-add-field",function(a){var b=($(this).parents(".field_tree_div"),$(this).parents("td"));b.find("[name=field_nm]").eq(0).val();if(b.find(".field_tree_div").length>=5)return void _alert("더이상 등록 할 수 없습니다.");for(var c=$('<span class="range-2 form-select-outer" />'),d=$('<select name="field_set_seq" class="form-select" aria-value="" />').append('<option value="">[선택]</option>').appendTo(c),e=1;e<f.count();e++){var g=f.getNodeByKey(String(e));if(e>1){var h;if(h=g.data.dto.join_field_list?g.data.dto.join_field_list[0].operator:i.form.find("[name=join_operator]").first().val(),"="!=h&&"=*"!=h)continue}d.append('<option value="'+e+'">DATA.'+e+"</option>")}var j=$('<span class="range-4" />'),k=($('<select name="field_nm" class="form-select" aria-value="" data-ui="false" />').append('<option value="*">[선택하세요]</option>').appendTo(j),$('<span class="range-2 form-select-outer" />')),l=($('<select name="field_func" class="form-select" />').append('<option value="8">일</option>').append('<option value="10">시</option>').append('<option value="11">10분</option>').append('<option value="12">1분</option>').appendTo(k),$('<span class="range-2" />')),m=($('<button type="button" class="btn-basic btn-mini btn-plus btn-add-field"><i class="icon-plus"></i></button>').appendTo(l),$('<button type="button" class="btn-basic btn-mini btn-minus btn-del-field"><i class="icon-minus"></i></button>').appendTo(l),$('<div class="field_tree_div ranges-group">').append(c,j,k,l));b.append(m),m.find("[name=field_nm]").chosen(),t(),u()}),i.form.on("click",".btn-del-field",function(a){var b=$(this).parents("td");if(1!=b.find(".field_tree_div").length){var c=$(this).parents("tr"),d=($(this).parents("td"),c.find("[name=view_type]").val(),$(this).parents(".field_tree_div"));d.remove()}})},y=function(){q(),n();var a=f.getActiveNode();if(null!=a&&0!=a.data.dto.set_seq){var b=p.getFormData();$.extend(a.data.dto,b),a.setTitle(b.title)}},z=function(){var a=$(this).val(),b=$(this).data("prev");if(i.form.find(".join_div").length>1)if("NOT IN"==a||"IN"==a){var c=$(this),d=$(this).closest(".join_div").siblings(".join_div");_confirm("다른 데이터관계 설정은 삭제됩니다.",{onAgree:function(){d.remove()},onDisagree:function(){c.val(b)}})}else i.form.find("[name=join_operator]").val(a);w();var e=f.getActiveNode(),g=e.data.dto.set_seq;"="!=a&&"=*"!=a?(i.form.find("[name=field_set_seq]").each(function(){if(g==$(this).val()){$(this).attr("aria-value","");var a=$(this).closest("td").find("[name=field_nm]"),b=new Object({data:{dto:{set_type:"del",file_id:""}}});s(a,b,"*")}}),i.form.find("[name=func_field_set_seq]").each(function(){if(g==$(this).val()){$(this).attr("aria-value","");var a=$(this).closest("td").find("[name=func_field_nm]"),b=new Object({data:{dto:{set_type:"del",file_id:""}}});s(a,b,"*")}}),i.form.find("[name=field_set_seq]").each(function(){var a=$(this).attr("aria-value");$(this).html("<option value=''>[선택]</option>");for(var b=1;b<f.count();b++)b!=g&&$(this).append("<option value='"+b+"'>DATA."+b+"</option>");$(this).val(a)}),i.form.find("[name=func_field_set_seq]").each(function(){var a=$(this).attr("aria-value");$(this).html("<option value=''>[선택]</option>");for(var b=1;b<f.count();b++)b!=g&&$(this).append("<option value='"+b+"'>DATA."+b+"</option>");$(this).val(a)})):(i.form.find("[name=field_set_seq]").each(function(){var a=$(this).attr("aria-value");$(this).html("<option value=''>[선택]</option>");for(var b=1;b<f.count();b++)$(this).append("<option value='"+b+"'>DATA."+b+"</option>");$(this).val(a)}),i.form.find("[name=func_field_set_seq]").each(function(){var a=$(this).attr("aria-value");$(this).html("<option value=''>[선택]</option>");for(var b=1;b<f.count();b++)$(this).append("<option value='"+b+"'>DATA."+b+"</option>");$(this).val(a)})),slui.attach.setTransformSelect(h.formId)},w=function(){var a=i.form.find("[name=join_operator]:first").val();"="==a||"=*"==a?i.btnFldJoin.css("visibility","visible"):i.btnFldJoin.css("visibility","hidden")},A=function(){var a=$(this).val();$(this).attr("aria-value",a);var b=$(this).closest("tr").find("[name=view_type]").val(),c=$(this).closest("div").find("[name=field_nm]");if("T"!=b||"eqp_dt"!=c.val())if(c.html("<option value='*'>[선택하세요]</option>"),""!=a){var d=f.getNodeByKey(a),e="*";s(c,d,e)}else c.trigger("chosen:updated")},B=function(){var a=$(this).val(),b=$(this).closest("div").find("[name=func_field_nm]");if($(this).attr("aria-value",a),b.html("<option value='*'>[선택하세요]</option>"),""!=a){var c=f.getNodeByKey(a),d="*";s(b,c,d)}else b.trigger("chosen:updated")},C=function(){if("T"==$(this).val()){for(var a=$(this).closest("tr"),b=a.find(".field_nm_td"),c=a.find(".field_tree_div").remove(),d=$('<span class="range-2 form-select-outer"/>'),e=$('<select name="field_set_seq" class="form-select" aria-value=""/>').append("<option value=''>[선택]</option>").appendTo(d),g=1;g<f.count();g++)e.append("<option value='"+g+"'>DATA."+g+"</option>");var i=$('<span class="range-4"/>'),j=$('<select name="field_nm" class="form-select" aria-value="" data-ui="false" disabled="true"/>').append("<option value='*'>[선택하세요]</option>");$.each(gFieldCaptions,function(a,b){"eqp_dt"==a?j.append("<option value='"+a+"' selected>"+b+" ["+a+"]</option>"):j.append("<option value='"+a+"'>"+b+" ["+a+"]</option>")}),j.appendTo(i);var k=$('<span class="range-2 form-select-outer" />'),l=($('<select name="field_func" class="form-select">').append("<option value='8'>일</option>").append("<option value='10'>시</option>").append("<option value='11'>10분</option>").append("<option value='12'>1분</option>").appendTo(k),$('<span class="range-2" />')),m=($('<button type="button" class="btn-basic btn-mini btn-plus btn-add-field"><i class="icon-plus"></i></button>').appendTo(l),$("<div class='field_tree_div ranges-group' />").append(d,i,k,l).appendTo(b));m.find("[name=field_nm]").chosen()}else{var a=$(this).parents("tr");c=a.find(".field_tree_div"),c.find("[name=field_nm]").prop("disabled",!1),c.find("[name=field_nm]").trigger("chosen:updated")}t(),u(),slui.attach.setTransformSelect(h.formId)},D=function(){var a=g,b=$.trim(a.data.dto.sql_query);return""==b?void _alert("Query를 입력해 주세요."):void $("body").requestData(h.urlLoadBigDbData,{sql_query:b},{callback:function(b,c,d){"SUC_COM_0000"==c?(f.getActiveNode().data.dto.checkDb=!0,H(a),_alert("필드정보Check 완료")):_alert("Query의 필드정보를 불러오는 중 에러가 발생했습니다.<br>Query를 확인해주세요.")}})},E=function(a){$("body").requestData(h.urlLoadBigFileData,{file_id:a},{callback:function(a,b,c){if("SUC_COM_0000"==b){var d=a.data;i.fileId.val(d.file_id),i.fileDataName.val(d.file_data_name),i.orgFileName.val(d.org_file_name);var e=f.getActiveNode();if(null!=e&&0!=e.data.dto.set_seq){var g=p.getFormData();$.extend(e.data.dto,g),e.setTitle(g.title),H(e)}}else _alert("파일 정보를 불러오는 중 에러가 발생했습니다.")}})},F=function(){var a=i.form.find("[name=join_operator]:first").val(),b=[],c=f.getActiveNode();if("="==a||"=*"==a){if(f.count()>3)return;if(!G(c.data.dto.set_type))return;if(null!=c){var d=p.getFormData();$.extend(c.data.dto,d),c.setTitle(d.title)}f.visit(function(a){var c=a.data.dto;0!=c.set_seq&&b.push(c)}),$("body").requestData(h.urlAutoJoinField,{join_field_info_list:b},{displayLoader:!0,callback:function(b,d,e){if("SUC_COM_0000"==d){var f=b.dupFldList;if(f.length>0){i.form.find(".join_div").remove();for(var g in f)r(c,f[g],f[g],a)}else _alert("공통 필드가 없습니다.")}else _alert("파일의 필드정보를 불러오는 중 에러가 발생했습니다.")}})}},G=function(a){var b=!0;switch(a){case"S":if(gNetworkList.length>1&&0==i.form.find("[name=client_group_cd]:checked").length)return _alert("검색할 Network을 체크하세요."),!1;var c=i.schStartDay.val()+i.schStartHour.val()+i.schStartMin.val(),d=i.schEndDay.val()+i.schEndHour.val()+i.schEndMin.val();_SL.formatDate.diff(c,d);if(c>d)return _alert("검색기간 종료시간이 시작시간보다 커야 합니다."),!1;_SL.validate(i.schQuery)||(b=!1);break;case"F":_SL.validate(i.fileDataName)||(b=!1);break;case"D":if(!_SL.validate(i.sqlQuery)){b=!1;break}g.data.dto.checkDb||(_alert("필드정보Check를 해주세요."),b=!1);break;default:return b=!1}return b},H=function(a){var b=a.data.dto.set_seq,c=i.form.find("[name=join_field_nm]"),d=i.form.find("[name=join_rel_field]");if(0==b||1==b)c.val("*"),c.trigger("chosen:updated"),d.val("*"),d.trigger("chosen:updated");else{var e=a.getParent(),f=a.data.dto.field_nm,g=a.data.dto.rel_field;(j.isNew||"9"==i.status.val())&&(c.prop("disabled",!1),d.prop("disabled",!1)),s(c,a,f),s(d,e,g)}},I=function(){var a=$(this).data("type");
if(_SL.validate(i.statsNm)){if(f.count()<=1)return void _alert("분석데이터를 등록해 주세요.");if(null!=g&&0!=g.data.dto.seq_no){if(!p.nodeValidate())return;var b=f.getActiveNode();if(null!=b){var c=p.getFormData();$.extend(b.data.dto,c),b.setTitle(c.title)}}_SL.validate(i.form.find("[name=item_nm]"))&&K()&&(L(),J(a))}},J=function(a){if("save"==a){i.form.find("[name=share_user_list] option").each(function(){this.selected=!0}),"big_stats_mng_load"==i.pageType.val()&&i.procPct.val(0);var b=(1==$(this).data("after-close"),$.extend({},_SL.serializeMap(i.form),{item_list_json:d,dataset_list_json:c}));$("body").requestData(j.mode.action,b,{callback:function(a,b,c){_alert(c,{onAgree:function(){O(!0)}})}})}else if("retry"==a){i.form.find("[name=share_user_list] option").each(function(){this.selected=!0});var b=(1==$(this).data("after-close"),$.extend({},_SL.serializeMap(i.form),{item_list_json:d,dataset_list_json:c}));$("body").requestData(j.mode.action,b,{callback:function(a,b,c){_alert(c,{onAgree:function(){O(!0)}})}})}else if("stop"==a){var e=i.scheduleId.val(),f=i.bigCode.val();$("body").requestData(h.urlChkLastCode,{schedule_id:e},{callback:function(a,b,c){a==f?$("body").requestData(h.urlStopBigStats,{big_code:f},{callback:function(a,b,c){O(!0)}}):_alert("상태가 변경되어 중지할 수 없습니다.",{onAgree:function(){O(!0)}})}})}},K=function(){for(var a=[],b=i.itemListTable,c=b.find("tr").length,e=!0,f=0;f<c;f++){var g=[],h=[],j=[];if(i.form.find(".field_nm_td").eq(f).find("[name=field_nm]").each(function(a){if(e){var b=a+1,c=$(this).val(),d=gFieldCaptions[c]?gFieldCaptions[c]:c,f=$(this).closest("td").find("[name=field_set_seq]").val();if("*"==c)return _alert("기준필드를 선택해 주세요."),void(e=!1);if(h.indexOf(f+c)!=-1)return _alert("기준필드에 중복된 값이 있습니다."),void(e=!1);if("eqp_dt"==c&&j.indexOf(c)!=-1)return _alert("장비 발생시간은 하나만 선택할 수 있습니다."),void(e=!1);if(""==f)return _alert("기준필드의 DATA번호를 선택해 주세요."),void(e=!1);h.push(f+c),j.push(c);var i=null;"eqp_dt"==c&&(i=$(this).closest("div").find("[name=field_func]").val()),g.push({field_seq:b,set_seq:f,field_nm:c,func:i,field_alias:d})}}),!e)return;var k="*",l=i.form.find(".field_nm_td").eq(f).find("[name=field_nm]").length+1,m=i.form.find("[name=func_field_set_seq]").eq(f).val(),n=gFieldCaptions[k],o=i.form.find("[name=func]").eq(f).val();if("count"!=o){if(k=i.form.find("[name=func_field_nm]").eq(f).val(),"*"==k)return _alert("통계필드를 선택해 주세요"),e=!1;n=gFieldCaptions[k]?gFieldCaptions[k]:k}else if(!m)return _alert("통계DATA를 선택해 주세요"),e=!1;g.push({field_seq:l,set_seq:m,field_nm:k,func:o,field_alias:n}),a.push({item_seq:f+1,item_nm:$.trim(i.form.find("[name=item_nm]").eq(f).val()),view_type:$.trim(i.form.find("[name=view_type]").eq(f).val()),group_field_list:g})}return d=a,e},L=function(){var a=[];f.visit(function(b){var c=b.data.dto;0!=c.set_seq&&a.push(c)}),c=a},M=function(){i.itemListTable.empty();var a=i.bigCode.val(),b={big_code:a},c=function(a){var b=a.datasetList,c=b[0],d=a.shareUserList;i.scheduleId.val(c.schedule_id),i.status.val(c.status),i.procPct.val(c.proc_pct),i.lastCodeYn.val(c.last_code_yn),_SL.setDataToForm(c,i.form);for(var e in d){var g=d[e],h=g.user_id,j=g.user_nm+" ["+g.user_id+"]";i.form.find("[name=share_user_list]").append($("<option value='"+h+"'>"+j+"</option>"))}var k,m,n,p;k=c.sch_start_dt,n=c.gen_cycle_type,p=c.gen_cycle_times,m="1dwM".indexOf(n)>0?n+",0":n+","+p,"w"==n&&i.genStartWeek.val(p),"M"==n&&i.genStartDay2.val(p<10?"0"+p:p),i.genCycleType.val(m),i.genSch.val("0"),""==k&&(k=_SL.formatDate()),i.genStartDay.val(k.substring(0,8)),i.genStartHour.val(k.substring(8,10)),i.genStartMin.val(k.substring(10,12)),o();for(var q in b){var r=b[q],t=r.rel_set_seq;r.checkDb=!0,null==t&&(t=0);var u;switch(r.set_type){case"S":u=r.set_seq+".[검색] : "+r.sch_query;break;case"F":u=r.set_seq+".[파일] : "+r.file_data_name;break;case"D":u=r.set_seq+".[DB] : "+r.sql_query}if(f.getNodeByKey(t.toString()).addChild({title:u,key:b[q].set_seq.toString(),dto:r,icon:!1,children:[]}),0==q){var w=f.getNodeByKey(b[q].set_seq.toString());w.activate()}}var x=a.itemList;for(var e in x)N(x[e]);v(),i.form.find("[name=field_set_seq]").each(function(){for(var a=$(this).attr("aria-value"),b=1;b<f.count();b++){var c=f.getNodeByKey(String(b));if(b>1){var d=c.data.dto.join_field_list[0].operator;if("="!=d&&"=*"!=d)continue}$(this).append("<option value='"+b+"'>DATA."+b+"</option>")}$(this).val(a)}),i.form.find("[name=func_field_set_seq]").each(function(){for(var a=$(this).attr("aria-value"),b=1;b<f.count();b++){var c=f.getNodeByKey(String(b));if(b>1){var d=c.data.dto.join_field_list[0].operator;if("="!=d&&"=*"!=d)continue}$(this).append("<option value='"+b+"'>DATA."+b+"</option>")}$(this).val(a)}),l(),$("[name=field_set_seq]").each(function(){var a=$(this).val(),b=$(this).parents("tr"),c=($(this).parents("td"),b.find("[name=view_type]").val(),$(this).closest("div").find("[name=field_nm]"));if(c.html("<option value='*'>[선택하세요]</option>"),""!=a){var d=f.getNodeByKey(a),e=c.attr("aria-value");s(c,d,e)}else c.trigger("chosen:updated")}),$("[name=func_field_set_seq]").each(function(){var a=$(this).val(),b=$(this).closest("td").find("[name=func_field_nm]");if(b.html("<option value='*'>[선택하세요]</option>"),""!=a){var c=f.getNodeByKey(a),d=b.attr("aria-value");s(b,c,d)}else b.trigger("chosen:updated")})};$("body").requestData(h.urlSelect,b,{callback:c,displayLoader:!0})},N=function(a){var b=i.itemListTable,c=$("<tr>"),d=a.item_nm,e=a.view_type,f=a.item_field_list;c.append('<td>\t\t\t\t\t\t<input name="item_nm" class="form-input form-block" type="text" data-valid="분석항목명,required" value="'+d+'">\t\t\t\t\t</td>'),c.append('<td>\t\t\t\t\t\t<span class="form-select-outer"><select name="view_type" class="form-select">\t\t\t\t\t\t\t<option value="P"'+("P"==e?" selected":"")+'>Pie</option>\t\t\t\t\t\t\t<option value="B"'+("B"==e?" selected":"")+'>Bar</option>\t\t\t\t\t\t\t<option value="L"'+("L"==e?" selected":"")+'>Line</option>\t\t\t\t\t\t\t<option value="T"'+("T"==e?" selected":"")+">TimeLine</option>\t\t\t\t\t\t</select></span>\t\t\t\t\t</td>");var g=$('<td class="field_nm_td">');for(var j in f){if(j==f.length-1)break;var k=f[j],l=k.set_seq,m=k.field_nm,n=k.func;g.append('<div class="field_tree_div ranges-group">\t\t\t\t\t\t\t<span class="range-2 form-select-outer">\t\t\t\t\t\t\t\t<select name="field_set_seq" class="form-select" aria-value="'+l+'">\t\t\t\t\t\t\t\t\t<option value="">[선택]</option>\t\t\t\t\t\t\t\t</select>\t\t\t\t\t\t\t</span>\t\t\t\t\t\t\t<span class="range-4">\t\t\t\t\t\t\t\t<select name="field_nm" class="form-select" aria-value="'+m+'" data-ui="false"'+("T"==e?' disabled="true"':"")+'>\t\t\t\t\t\t\t\t\t<option value="*">[선택하세요]</option>\t\t\t\t\t\t\t\t</select>\t\t\t\t\t\t\t</span>\t\t\t\t\t\t\t<span class="range-2 form-select-outer">\t\t\t\t\t\t\t\t<select name="field_func" class="form-select">\t\t\t\t\t\t\t\t\t<option value="8"'+("8"==n?" selected":"")+'>일</option>\t\t\t\t\t\t\t\t\t<option value="10"'+("10"==n?" selected":"")+'>시</option>\t\t\t\t\t\t\t\t\t<option value="11"'+("11"==n?" selected":"")+'>10분</option>\t\t\t\t\t\t\t\t\t<option value="12"'+("12"==n?" selected":"")+'>1분</option>\t\t\t\t\t\t\t\t</select>\t\t\t\t\t\t\t</span>\t\t\t\t\t\t\t<span class="range-2">\t\t\t\t\t\t\t\t<button type="button" class="btn-basic btn-mini btn-add-field"><i class="icon-plus"></i></button><button type="button" class="btn-basic btn-mini btn-minus btn-del-field" ><i class="icon-minus"></i></button>\t\t\t\t\t\t\t</div>')}c.append(g);var o=f[f.length-1];c.append('<td>\t\t\t\t\t<div class="ranges-group">\t\t\t\t\t\t<span class="range-2 form-select-outer">\t\t\t\t\t\t\t<select name="func" class="form-select">\t\t\t\t\t\t\t\t<option value="count"'+("count"==o.func?" selected":"")+'>Count</option>\t\t\t\t\t\t\t\t<option value="sum"'+("sum"==o.func?" selected":"")+'>SUM</option>\t\t\t\t\t\t\t\t<option value="avg"'+("avg"==o.func?" selected":"")+'>AVG</option>\t\t\t\t\t\t\t\t<option value="max"'+("max"==o.func?" selected":"")+'>MAX</option>\t\t\t\t\t\t\t\t<option value="min"'+("min"==o.func?" selected":"")+'>MIN</option>\t\t\t\t\t\t\t</select>\t\t\t\t\t\t</span>\t\t\t\t\t\t<span class="range-3 form-select-outer func_field_span">\t\t\t\t\t\t\t<select name="func_field_set_seq" class="form-select" aria-value="'+o.set_seq+'">\t\t\t\t\t\t\t\t<option value="">[선택]</option>\t\t\t\t\t\t\t</select>\t\t\t\t\t\t</span>\t\t\t\t\t\t<span class="range-5 form-select-outer">\t\t\t\t\t\t\t<select name="func_field_nm" class="form-select" aria-value="'+o.field_nm+'" data-ui="false">\t\t\t\t\t\t\t\t<option value="*">[선택하세요]</option>\t\t\t\t\t\t\t</select>\t\t\t\t\t\t</span>\t\t\t\t\t</div>\t\t\t\t</td>'),c.append('<td class="imgTd">\t\t\t\t\t\t<button type="button" class="btn-basic btn-mini btn-minus btn-del-item"><i class="icon-minus"></i></button>\t\t\t\t\t</td>'),c.appendTo(b),setTimeout(function(){slui.attach.setTransformSelect(h.formId),i.form.parents(".nano").nanoScroller()},10)},O=function(a){a&&i.form.find("[data-layer-close=true]").click()};return{init:k,loadFileInfo:E}}(),$(function(){slapp.bigStatsManager.form.init()});